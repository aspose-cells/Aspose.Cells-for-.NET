!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(t,e){},function(t,e,n){},function(t,e,n){"use strict";function r(t){return function(t){if(Array.isArray(t))return t}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(t,e)}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n.r(e),n.d(e,"spreadsheet",(function(){return Fs}));var c=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";o(this,t),"string"==typeof e?(this.el=document.createElement(e),this.el.className=n):this.el=e,this.data={}}var e,n,i;return e=t,(n=[{key:"data",value:function(t,e){return void 0!==e?(this.data[t]=e,this):this.data[t]}},{key:"on",value:function(t,e){var n=r(t.split(".")),i=n[0],o=n.slice(1),a=i;return"mousewheel"===a&&/Firefox/i.test(window.navigator.userAgent)&&(a="DOMMouseScroll"),this.el.addEventListener(a,(function(t){e(t);for(var n=0;n<o.length;n+=1){var r=o[n];if("left"===r&&0!==t.button)return;if("right"===r&&2!==t.button)return;"stop"===r&&t.stopPropagation()}})),this}},{key:"offset",value:function(t){var e=this;if(void 0!==t)return Object.keys(t).forEach((function(n){e.css(n,"".concat(t[n],"px"))})),this;var n=this.el;return{top:n.offsetTop,left:n.offsetLeft,height:n.offsetHeight,width:n.offsetWidth}}},{key:"scroll",value:function(t){var e=this.el;return void 0!==t&&(void 0!==t.left&&(e.scrollLeft=t.left),void 0!==t.top&&(e.scrollTop=t.top)),{left:e.scrollLeft,top:e.scrollTop}}},{key:"box",value:function(){return this.el.getBoundingClientRect()}},{key:"parent",value:function(){return new t(this.el.parentNode)}},{key:"children",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return 0===arguments.length?this.el.childNodes:(n.forEach((function(e){return t.child(e)})),this)}},{key:"removeChild",value:function(t){this.el.removeChild(t)}},{key:"child",value:function(e){var n=e;return"string"==typeof e?n=document.createTextNode(e):e instanceof t&&(n=e.el),this.el.appendChild(n),this}},{key:"contains",value:function(t){return this.el.contains(t)}},{key:"className",value:function(t){return void 0!==t?(this.el.className=t,this):this.el.className}},{key:"addClass",value:function(t){return this.el.classList.add(t),this}},{key:"hasClass",value:function(t){return this.el.classList.contains(t)}},{key:"removeClass",value:function(t){return this.el.classList.remove(t),this}},{key:"toggle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"active";return this.toggleClass(t)}},{key:"toggleClass",value:function(t){return this.el.classList.toggle(t)}},{key:"active",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"active";return t?this.addClass(e):this.removeClass(e),this}},{key:"checked",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.active(t,"checked"),this}},{key:"disabled",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return t?this.addClass("disabled"):this.removeClass("disabled"),this}},{key:"attr",value:function(t,e){var n=this;if(void 0!==e)this.el.setAttribute(t,e);else{if("string"==typeof t)return this.el.getAttribute(t);Object.keys(t).forEach((function(e){n.el.setAttribute(e,t[e])}))}return this}},{key:"removeAttr",value:function(t){return this.el.removeAttribute(t),this}},{key:"html",value:function(t){return void 0!==t?(this.el.innerHTML=t,this):this.el.innerHTML}},{key:"val",value:function(t){return void 0!==t?(this.el.value=t,this):this.el.value}},{key:"focus",value:function(){this.el.focus()}},{key:"cssRemoveKeys",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.forEach((function(e){return t.el.style.removeProperty(e)})),this}},{key:"css",value:function(t,e){var n=this;return void 0===e&&"string"!=typeof t?(Object.keys(t).forEach((function(e){n.el.style[e]=t[e]})),this):void 0!==e?(this.el.style[t]=e,this):this.el.style[t]}},{key:"computedStyle",value:function(){return window.getComputedStyle(this.el,null)}},{key:"show",value:function(){return this.css("display","block"),this}},{key:"hide",value:function(){return this.css("display","none"),this}}])&&a(e.prototype,n),i&&a(e,i),t}(),l=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new c(t,e)};n(0);function u(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,c=t[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var f=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function h(t){for(var e="",n=t;n>=f.length;)n/=f.length,n-=1,e+=f[parseInt(n,10)%f.length];return e+=f[t%f.length]}function p(t){for(var e=0,n=0;n<t.length-1;n+=1){var r=t.charCodeAt(n)-65,i=t.length-1-n;e+=Math.pow(f.length,i)+f.length*r}return e+=t.charCodeAt(t.length-1)-65}function y(t){for(var e="",n="",r=0;r<t.length;r+=1)t.charAt(r)>="0"&&t.charAt(r)<="9"?n+=t.charAt(r):e+=t.charAt(r);return[p(e),parseInt(n,10)-1]}function d(t,e){return"".concat(h(t)).concat(e+1)}function v(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return!0};if(0===e&&0===n)return t;var i=y(t),o=u(i,2),a=o[0],c=o[1];return r(a,c)?d(a+e,c+n):t}function b(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,c=t[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return m(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function g(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function w(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var k=function(){function t(e,n,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;g(this,t),this.sri=e,this.sci=n,this.eri=r,this.eci=i,this.w=o,this.h=a}var e,n,r;return e=t,r=[{key:"valueOf",value:function(e){var n=e.split(":"),r=b(y(n[0]),2),i=r[0],o=r[1],a=o,c=i;if(n.length>1){var l=b(y(n[1]),2);c=l[0],a=l[1]}return new t(o,i,a,c)}}],(n=[{key:"set",value:function(t,e,n,r){this.sri=t,this.sci=e,this.eri=n,this.eci=r}},{key:"multiple",value:function(){return this.eri-this.sri>0||this.eci-this.sci>0}},{key:"includes",value:function(){for(var t=0,e=0,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];if(1===r.length){var o=y(r[0]),a=b(o,2);e=a[0],t=a[1]}else 2===r.length&&(t=r[0],e=r[1]);var c=this.sri,l=this.sci,u=this.eri,s=this.eci;return c<=t&&t<=u&&l<=e&&e<=s}},{key:"each",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},n=this.sri,r=this.sci,i=this.eri,o=this.eci,a=n;a<=i;a+=1)if(e(a))for(var c=r;c<=o;c+=1)t(a,c)}},{key:"contains",value:function(t){return this.sri<=t.sri&&this.sci<=t.sci&&this.eri>=t.eri&&this.eci>=t.eci}},{key:"within",value:function(t){return this.sri>=t.sri&&this.sci>=t.sci&&this.eri<=t.eri&&this.eci<=t.eci}},{key:"disjoint",value:function(t){return this.sri>t.eri||this.sci>t.eci||t.sri>this.eri||t.sci>this.eci}},{key:"intersects",value:function(t){return this.sri<=t.eri&&this.sci<=t.eci&&t.sri<=this.eri&&t.sci<=this.eci}},{key:"union",value:function(e){var n=this.sri,r=this.sci,i=this.eri,o=this.eci;return new t(e.sri<n?e.sri:n,e.sci<r?e.sci:r,e.eri>i?e.eri:i,e.eci>o?e.eci:o)}},{key:"difference",value:function(e){var n=[],r=function(e,r,i,o){n.push(new t(e,r,i,o))},i=this.sri,o=this.sci,a=this.eri,c=this.eci,l=e.sri-i,u=e.sci-o,s=a-e.eri,f=c-e.eci;return l>0?(r(i,o,e.sri-1,c),s>0?(r(e.eri+1,o,a,c),u>0&&r(e.sri,o,e.eri,e.sci-1),f>0&&r(e.sri,e.eci+1,e.eri,c)):(u>0&&r(e.sri,o,a,e.sci-1),f>0&&r(e.sri,e.eci+1,a,c))):s>0&&(r(e.eri+1,o,a,c),u>0&&r(i,o,e.eri,e.sci-1),f>0&&r(i,e.eci+1,e.eri,c)),u>0?(r(i,o,a,e.sci-1),f>0?(r(i,e.eri+1,a,c),l>0&&r(i,e.sci,e.sri-1,e.eci),s>0&&r(e.sri+1,e.sci,a,e.eci)):(l>0&&r(i,e.sci,e.sri-1,c),s>0&&r(e.sri+1,e.sci,a,c))):f>0&&(r(a,e.eci+1,a,c),l>0&&r(i,o,e.sri-1,e.eci),s>0&&r(e.eri+1,o,a,e.eci)),n}},{key:"size",value:function(){return[this.eri-this.sri+1,this.eci-this.sci+1]}},{key:"toString",value:function(){var t=this.sri,e=this.sci,n=this.eri,r=this.eci,i=d(e,t);return this.multiple()&&(i="".concat(i,":").concat(d(r,n))),i}},{key:"clone",value:function(){return new t(this.sri,this.sci,this.eri,this.eci,this.w,this.h)}},{key:"equals",value:function(t){return this.eri===t.eri&&this.eci===t.eci&&this.sri===t.sri&&this.sci===t.sci}}])&&w(e.prototype,n),r&&w(e,r),t}();function S(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var O=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.range=new k(0,0,0,0),this.ri=0,this.ci=0}var e,n,r;return e=t,(n=[{key:"multiple",value:function(){return this.range.multiple()}},{key:"setIndexes",value:function(t,e){this.ri=t,this.ci=e}},{key:"size",value:function(){return this.range.size()}}])&&S(e.prototype,n),r&&S(e,r),t}();var x=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=0,this.y=0,this.ri=0,this.ci=0,this.riact=0};function j(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var E=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.undoItems=[],this.redoItems=[]}var e,n,r;return e=t,(n=[{key:"add",value:function(t){this.undoItems.push(JSON.stringify(t)),this.redoItems=[]}},{key:"canUndo",value:function(){return this.undoItems.length>0}},{key:"canRedo",value:function(){return this.redoItems.length>0}},{key:"undo",value:function(t,e){var n=this.undoItems,r=this.redoItems;this.canUndo()&&(r.push(JSON.stringify(t)),e(JSON.parse(n.pop())))}},{key:"redo",value:function(t,e){var n=this.undoItems,r=this.redoItems;this.canRedo()&&(n.push(JSON.stringify(t)),e(JSON.parse(r.pop())))}}])&&j(e.prototype,n),r&&j(e,r),t}();function C(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var R=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.range=null,this.state="clear",this.textdata=null}var e,n,r;return e=t,(n=[{key:"copy",value:function(t,e){this.range=t,this.state="copy";for(var n=t.sri,r=t.sci,i=t.eri,o=t.eci,a="",c=n;c<=i;c+=1){if(e._[c])for(var l=r;l<=o;l+=1){if(e._[c].cells&&e._[c].cells[l]){var u=e._[c].cells[l].text;u.indexOf("\n")>=0&&(u='"'+u+'"'),a+=u}a+="\t"}a+="\n"}return this.setData(a),this}},{key:"cut",value:function(t){return this.range=t,this.state="cut",this}},{key:"isCopy",value:function(){return"copy"===this.state}},{key:"isCut",value:function(){return"cut"===this.state}},{key:"isClear",value:function(){return"clear"===this.state}},{key:"clear",value:function(){this.range=null,this.state="clear"}},{key:"setData",value:function(t){this.textdata=t,this.copyTextToClipboard(t)}},{key:"fallbackCopyTextToClipboard",value:function(t){var e=document.createElement("textarea");e.value=t,e.style.top="0",e.style.left="0",e.style.position="fixed",document.body.appendChild(e),e.focus(),e.select();try{var n=document.execCommand("copy")?"successful":"unsuccessful";console.log("Fallback: Copying text command was "+n)}catch(t){console.error("Fallback: Oops, unable to copy",t)}document.body.removeChild(e)}},{key:"copyTextToClipboard",value:function(t){navigator.clipboard?navigator.clipboard.writeText(t).then((function(){console.log("Async: Copying to clipboard was successful!")}),(function(t){console.error("Async: Could not copy text: ",t)})):this.fallbackCopyTextToClipboard(t)}}])&&C(e.prototype,n),r&&C(e,r),t}();function _(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function A(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function P(t,e,n){return e&&A(t.prototype,e),n&&A(t,n),t}var T=function(){function t(e,n,r){_(this,t),this.ci=e,this.operator=n,this.value=r}return P(t,[{key:"set",value:function(t,e){this.operator=t,this.value=e}},{key:"includes",value:function(t){var e=this.operator,n=this.value;return"all"===e||"in"===e&&n.includes(t)}},{key:"vlength",value:function(){var t=this.operator,e=this.value;return"in"===t?e.length:0}},{key:"getData",value:function(){return{ci:this.ci,operator:this.operator,value:this.value}}}]),t}(),D=function(){function t(e,n){_(this,t),this.ci=e,this.order=n}return P(t,[{key:"asc",value:function(){return"asc"===this.order}},{key:"desc",value:function(){return"desc"===this.order}}]),t}(),I=function(){function t(){_(this,t),this.ref=null,this.filters=[],this.sort=null}return P(t,[{key:"setData",value:function(t){var e=t.ref,n=t.filters,r=t.sort;null!=e&&(this.ref=e,this.filters=n.map((function(t){return new T(t.ci,t.operator,t.value)})),r&&(this.sort=new D(r.ci,r.order)))}},{key:"getData",value:function(){if(this.active()){var t=this.ref,e=this.filters,n=this.sort;return{ref:t,filters:e.map((function(t){return t.getData()})),sort:n}}return{}}},{key:"addFilter",value:function(t,e,n){var r=this.getFilter(t);null==r?this.filters.push(new T(t,e,n)):r.set(e,n)}},{key:"setSort",value:function(t,e){this.sort=e?new D(t,e):null}},{key:"includes",value:function(t,e){return!!this.active()&&this.hrange().includes(t,e)}},{key:"getSort",value:function(t){var e=this.sort;return e&&e.ci===t?e:null}},{key:"getFilter",value:function(t){for(var e=this.filters,n=0;n<e.length;n+=1)if(e[n].ci===t)return e[n];return null}},{key:"filteredRows",value:function(t){var e=new Set,n=new Set;if(this.active())for(var r=this.range(),i=r.sri,o=r.eri,a=this.filters,c=i+1;c<=o;c+=1)for(var l=0;l<a.length;l+=1){var u=a[l],s=t(c,u.ci),f=s&&0!=s.text.trim().length?s.text:"";if(!u.includes(f)){e.add(c);break}n.add(c)}return{rset:e,fset:n}}},{key:"items",value:function(t,e){var n={};if(this.active())for(var r=this.range(),i=r.sri,o=r.eri,a=i+1;a<=o;a+=1){var c=e(a,t);if(null===c||/^\s*$/.test(c.text))n[""]=(n[""]||0)+1;else{var l=c.text,u=(n[l]||0)+1;n[l]=u}}return n}},{key:"range",value:function(){return k.valueOf(this.ref)}},{key:"hrange",value:function(){var t=this.range();return t.eri=t.sri,t}},{key:"clear",value:function(){this.ref=null,this.filters=[],this.sort=null}},{key:"active",value:function(){return null!==this.ref}}]),t}();function z(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function M(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var N=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];z(this,t),this._=e}var e,n,r;return e=t,(n=[{key:"forEach",value:function(t){this._.forEach(t)}},{key:"deleteWithin",value:function(t){this._=this._.filter((function(e){return!e.within(t)}))}},{key:"getFirstIncludes",value:function(t,e){for(var n=0;n<this._.length;n+=1){var r=this._[n];if(r.includes(t,e))return r}return null}},{key:"filterIntersects",value:function(e){return new t(this._.filter((function(t){return t.intersects(e)})))}},{key:"intersects",value:function(t){for(var e=0;e<this._.length;e+=1)if(this._[e].intersects(t))return!0;return!1}},{key:"union",value:function(t){var e=t;return this._.forEach((function(t){t.intersects(e)&&(e=t.union(e))})),e}},{key:"add",value:function(t){this.deleteWithin(t),this._.push(t)}},{key:"shift",value:function(t,e,n,r){this._.forEach((function(i){var o=i.sri,a=i.sci,c=i.eri,l=i.eci,u=i;"row"===t?o>=e?(u.sri+=n,u.eri+=n):o<e&&e<=c&&(u.eri+=n,r(o,a,n,0)):"column"===t&&(a>=e?(u.sci+=n,u.eci+=n):a<e&&e<=l&&(u.eci+=n,r(o,a,0,n)))}))}},{key:"move",value:function(t,e,n){this._.forEach((function(r){var i=r;i.within(t)&&(i.eri+=e,i.sri+=e,i.sci+=n,i.eci+=n)}))}},{key:"setData",value:function(t){return this._=t.map((function(t){return k.valueOf(t)})),this}},{key:"getData",value:function(){return this._.map((function(t){return t.toString()}))}}])&&M(e.prototype,n),r&&M(e,r),t}();var H=function t(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.forEach((function(n){Object.keys(n).forEach((function(r){var i=n[r];"string"==typeof i||"number"==typeof i||"boolean"==typeof i?e[r]=i:"function"!=typeof i&&!Array.isArray(i)&&i instanceof Object?(e[r]=e[r]||{},t(e[r],i)):e[r]=i}))})),e};function F(t){for(var e="".concat(t),n=0,r=!1,i=0;i<e.length;i+=1)!0===r&&(n+=1),"."===e.charAt(i)&&(r=!0);return n}function W(t,e,n){if(Number.isNaN(e)||Number.isNaN(n))return e+t+n;var r=F(e),i=F(n),o=Number(e),a=Number(n),c=0;return"-"===t?c=o-a:"+"===t?c=o+a:"*"===t?c=o*a:"/"===t&&(c=o/a),c.toFixed(Math.max(r,i))}var V={cloneDeep:function(t){return JSON.parse(JSON.stringify(t))},merge:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return H.apply(void 0,[{}].concat(e))},equals:function t(e,n){var r=Object.keys(e);if(r.length!==Object.keys(n).length)return!1;for(var i=0;i<r.length;i+=1){var o=r[i],a=e[o],c=n[o];if(void 0===c)return!1;if("string"==typeof a||"number"==typeof a||"boolean"==typeof a){if(a!==c)return!1}else if(Array.isArray(a)){if(a.length!==c.length)return!1;for(var l=0;l<a.length;l+=1)if(!t(a[l],c[l]))return!1}else if("function"!=typeof a&&!Array.isArray(a)&&a instanceof Object&&!t(a,c))return!1}return!0},arrayEquals:function(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n+=1)if(t[n]!==e[n])return!1;return!0},sum:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t},n=0,r=0;return Object.keys(t).forEach((function(i){n+=e(t[i],i),r+=1})),[n,r]},rangeEach:function(t,e,n){for(var r=t;r<e;r+=1)n(r)},rangeSum:function(t,e,n){for(var r=0,i=t;i<e;i+=1)r+=n(i);return r},rangeReduceIf:function(t,e,n,r,i,o){for(var a=n,c=r,l=t;l<e&&!(a>i);l+=1)a+=c=o(l);return[l,a-c,c]},deleteProperty:function(t,e){var n=t["".concat(e)];return delete t["".concat(e)],n},numberCalc:W};function U(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,c=t[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return q(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return q(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function L(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var B=function(){function t(e){var n=e.len,r=e.height;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._={},this.len=n,this.height=r}var e,n,r;return e=t,(n=[{key:"getHeight",value:function(t,e){if(this.isHide(t))return 0;if(e&&e.has(t))return 0;var n=this.get(t);return n&&n.height?n.height:this.height}},{key:"setHeight",value:function(t,e){this.getOrNew(t).height=e}},{key:"unhide",value:function(t){for(var e=t;e>0&&(e-=1,this.isHide(e));)this.setHide(e,!1)}},{key:"isHide",value:function(t){var e=this.get(t);return e&&e.hide}},{key:"setHide",value:function(t,e){var n=this.getOrNew(t);!0===e?n.hide=!0:delete n.hide}},{key:"setStyle",value:function(t,e){this.getOrNew(t).style=e}},{key:"sumHeight",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;return V.rangeSum(t,e,(function(t){return r&&r.has(t)?0:n.getHeight(t)}))}},{key:"totalHeight",value:function(){return this.sumHeight(0,this.len)}},{key:"get",value:function(t){return this._[t]}},{key:"getOrNew",value:function(t){return this._[t]=this._[t]||{cells:{}},this._[t]}},{key:"getCell",value:function(t,e){var n=this.get(t);return void 0!==n&&void 0!==n.cells&&void 0!==n.cells[e]?n.cells[e]:null}},{key:"getCellMerge",value:function(t,e){var n=this.getCell(t,e);return n&&n.merge?n.merge:[0,0]}},{key:"getCellOrNew",value:function(t,e){var n=this.getOrNew(t);return n.cells[e]=n.cells[e]||{},n.cells[e]}},{key:"setCell",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"all",i=this.getOrNew(t);"all"===r?i.cells[e]=n:"text"===r?(i.cells[e]=i.cells[e]||{},i.cells[e].text=n.text):"format"===r&&(i.cells[e]=i.cells[e]||{},i.cells[e].style=n.style,n.merge&&(i.cells[e].merge=n.merge))}},{key:"setCellText",value:function(t,e,n){var r=this.getCellOrNew(t,e);r.text=n,""!=n&&"="===n[0]&&(r.f=n)}},{key:"copyPaste",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},o=t.sri,a=t.sci,c=t.eri,l=t.eci,u=new Array,s=e.sri,f=e.sci,h=e.eri,p=e.eci,y=t.size(),d=U(y,2),b=d[0],m=d[1],g=e.size(),w=U(g,2),k=w[0],S=w[1],O=!0,x=0;(h<o||p<a)&&(O=!1,x=h<o?k:S);for(var j=o;j<=c;j+=1)if(this._[j])for(var E=a;E<=l;E+=1)if(this._[j].cells&&this._[j].cells[E])for(var C=s;C<=h;C+=b)for(var R=f;R<=p;R+=m){var _=C+(j-o),A=R+(E-a),P=V.cloneDeep(this._[j].cells[E]);r&&P&&P.text&&P.text.length>0&&function(){var t=P.text,e=R-f+(C-s)+2;if(O||(e-=x+1),"="===t[0])P.text=t.replace(/\w{1,3}\d/g,(function(t){var n=0,r=0;return o===s?n=e-1:r=e-1,/^\d+$/.test(t)?t:v(t,n,r)}));else if(b<=1&&m>1&&(s>c||h<o)||m<=1&&b>1&&(f>l||p<a)||b<=1&&m<=1){var n=/[\\.\d]+$/.exec(t);if(null!==n){var r=Number(n[0])+e-1;P.text=t.substring(0,n.index)+r}}}(),this.setCell(_,A,P,n),i(_,A,P);var T={ri:_,ci:A,text:P.f?P.f:P.text};u.push(T)}return u}},{key:"cutPaste",value:function(t,e){var n=this,r={};this.each((function(i){n.eachCells(i,(function(o){var a=parseInt(i,10),c=parseInt(o,10);t.includes(i,o)&&(a=e.sri+(a-t.sri),c=e.sci+(c-t.sci)),r[a]=r[a]||{cells:{}},r[a].cells[c]=n._[i].cells[o],r[a].height=n._[i].height}))})),this._=r}},{key:"paste",value:function(t,e){var n=this;if(!(t.length<=0)){var r=e.sri,i=e.sci;t.forEach((function(t,e){var o=r+e;t.forEach((function(t,e){var r=i+e;n.setCellText(o,r,t)}))}))}}},{key:"insert",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r={};this.each((function(i,o){var a=parseInt(i,10);a>=t&&(a+=n,e.eachCells(i,(function(e,r){r.text&&"="===r.text[0]&&(r.text=r.text.replace(/\w{1,3}\d/g,(function(e){return v(e,0,n,(function(e,n){return n>=t}))})))}))),r[a]=o})),this._=r,this.len+=n}},{key:"delete",value:function(t,e){var n=this,r=e-t+1,i={};this.each((function(o,a){var c=parseInt(o,10);c<t?i[c]=a:o>e&&(i[c-r]=a,n.eachCells(o,(function(t,n){n.text&&"="===n.text[0]&&(n.text=n.text.replace(/\w{1,3}\d/g,(function(t){return v(t,0,-r,(function(t,n){return n>e}))})))})))})),this._=i,this.len-=r}},{key:"insertColumn",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.each((function(r,i){var o={};e.eachCells(r,(function(e,r){var i=parseInt(e,10);i>=t&&(i+=n,r.text&&"="===r.text[0]&&(r.text=r.text.replace(/\w{1,3}\d/g,(function(e){return v(e,n,0,(function(e){return e>=t}))})))),o[i]=r})),i.cells=o}))}},{key:"deleteColumn",value:function(t,e){var n=this,r=e-t+1;this.each((function(i,o){var a={};n.eachCells(i,(function(n,i){var o=parseInt(n,10);o<t?a[o]=i:o>e&&(a[o-r]=i,i.text&&"="===i.text[0]&&(i.text=i.text.replace(/\w{1,3}\d/g,(function(t){return v(t,-r,0,(function(t){return t>e}))}))))})),o.cells=a}))}},{key:"deleteCells",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";t.each((function(t,r){e.deleteCell(t,r,n)}))}},{key:"deleteCell",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all",r=this.get(t);if(null!==r){var i=this.getCell(t,e);null!==i&&("all"===n?delete r.cells[e]:"text"===n?(i.text&&delete i.text,i.value&&delete i.value):"format"===n?(void 0!==i.style&&delete i.style,i.merge&&delete i.merge):"merge"===n&&i.merge&&delete i.merge)}}},{key:"maxCell",value:function(){var t=Object.keys(this._),e=t[t.length-1],n=this._[e];if(n){var r=n.cells,i=Object.keys(r),o=i[i.length-1];return[parseInt(e,10),parseInt(o,10)]}return[0,0]}},{key:"each",value:function(t){Object.entries(this._).forEach((function(e){var n=U(e,2),r=n[0],i=n[1];t(r,i)}))}},{key:"eachCells",value:function(t,e){this._[t]&&this._[t].cells&&Object.entries(this._[t].cells).forEach((function(t){var n=U(t,2),r=n[0],i=n[1];e(r,i)}))}},{key:"setData",value:function(t){t.len&&(this.len=t.len,delete t.len),this._=t}},{key:"getData",value:function(){var t=this.len;return Object.assign({len:t},this._)}}])&&L(e.prototype,n),r&&L(e,r),t}();function Y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var X=function(){function t(e){var n=e.len,r=e.width,i=e.indexWidth,o=e.minWidth;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._={},this.len=n,this.width=r,this.indexWidth=i,this.minWidth=o}var e,n,r;return e=t,(n=[{key:"setData",value:function(t){t.len&&(this.len=t.len,delete t.len),this._=t}},{key:"getData",value:function(){var t=this.len;return Object.assign({len:t},this._)}},{key:"getWidth",value:function(t){if(this.isHide(t))return 0;var e=this._[t];return e&&e.width?e.width:this.width}},{key:"getOrNew",value:function(t){return this._[t]=this._[t]||{},this._[t]}},{key:"setWidth",value:function(t,e){this.getOrNew(t).width=e}},{key:"unhide",value:function(t){for(var e=t;e>0&&(e-=1,this.isHide(e));)this.setHide(e,!1)}},{key:"isHide",value:function(t){var e=this._[t];return e&&e.hide}},{key:"setHide",value:function(t,e){var n=this.getOrNew(t);!0===e?n.hide=!0:delete n.hide}},{key:"setStyle",value:function(t,e){this.getOrNew(t).style=e}},{key:"sumWidth",value:function(t,e){var n=this;return V.rangeSum(t,e,(function(t){return n.getWidth(t)}))}},{key:"totalWidth",value:function(){return this.sumWidth(0,this.len)}}])&&Y(e.prototype,n),r&&Y(e,r),t}();function Z(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return K(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return K(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,c=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){c=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw o}}}}function K(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var J=["en"],G={en:{toolbar:{undo:"Undo",redo:"Redo",print:"Print",paintformat:"Paint format",clearformat:"Clear format",format:"Format",fontName:"Font",fontSize:"Font size",fontBold:"Font bold",fontItalic:"Font italic",underline:"Underline",strike:"Strike",color:"Text color",bgcolor:"Fill color",border:"Borders",merge:"Merge cells",align:"Horizontal align",valign:"Vertical align",textwrap:"Text wrapping",freeze:"Freeze cell",autofilter:"Filter",formula:"Functions",more:"More",sort:"Sort",pagination:"Pagination",search:"Search"},contextmenu:{copy:"Copy",cut:"Cut",paste:"Paste",pasteValue:"Paste values only",pasteFormat:"Paste format only",hide:"Hide",insertRow:"Insert row",insertColumn:"Insert column",deleteSheet:"Delete",deleteRow:"Delete row",deleteColumn:"Delete column",deleteCell:"Delete cell",deleteCellText:"Delete cell text",validation:"Data validations",sort:"Sort",cellprintable:"Enable export",cellnonprintable:"Disable export",celleditable:"Enable editing",cellnoneditable:"Disable editing"},print:{size:"Paper size",orientation:"Page orientation",orientations:["Landscape","Portrait"]},format:{normal:"Normal",text:"Plain Text",number:"Number",percent:"Percent",rmb:"RMB",usd:"USD",eur:"EUR",date:"Date",time:"Time",datetime:"Date time",duration:"Duration"},formula:{sum:"Sum",average:"Average",max:"Max",min:"Min",_if:"IF",and:"AND",or:"OR",concat:"Concat"},validation:{required:"it must be required",notMatch:"it not match its validation rule",between:"it is between {} and {}",notBetween:"it is not between {} and {}",notIn:"it is not in list",equal:"it equal to {}",notEqual:"it not equal to {}",lessThan:"it less than {}",lessThanEqual:"it less than or equal to {}",greaterThan:"it greater than {}",greaterThanEqual:"it greater than or equal to {}"},error:{pasteForMergedCell:"Unable to do this for merged cells"},calendar:{weeks:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"]},button:{next:"Next",cancel:"Cancel",remove:"Remove",save:"Save",ok:"OK",previous:"Previous",close:"Close"},sort:{desc:"Sort Z -> A",asc:"Sort A -> Z"},filter:{empty:"empty"},dataValidation:{mode:"Mode",range:"Cell Range",criteria:"Criteria",modeType:{cell:"Cell",column:"Column",row:"Row"},type:{list:"List",number:"Number",date:"Date",phone:"Phone",email:"Email"},operator:{be:"between",nbe:"not between",lt:"less than",lte:"less than or equal to",gt:"greater than",gte:"greater than or equal to",eq:"equal to",neq:"not equal to"}},dataSort:{ci:"Range",criteria:"Criteria",order:{asc:"ASC",desc:"DESC"}},dataSearch:{label:"Keywords"}}};function Q(t,e){if(e){var n,r=Z(J);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!e[i])break;for(var o=e[i],a=t.match(/(?:\\.|[^.])+/g),c=0;c<a.length;c+=1){var l=o[a[c]];if(!l)break;if(c===a.length-1)return l;o=l}}}catch(t){r.e(t)}finally{r.f()}}}function tt(t){var e=Q(t,G);return!e&&window&&window.x_spreadsheet&&window.x_spreadsheet.$messages&&(e=Q(t,window.x_spreadsheet.$messages)),e||""}function et(t){return function(){return tt(t)}}function nt(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n?J=[t]:J.unshift(t),e&&(G[t]=e)}function rt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,c=t[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return it(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return it(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function it(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ot(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var at={phone:/^[1-9]\d{10}$/,email:/^(\w)+(\.\w+)*@(\w)+((\.\w+)+)$/};function ct(t,e){var n="";if(!t){for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];n=tt.apply(void 0,["validation.".concat(e)].concat(i))}return[t,n]}var lt=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.required=n,this.value=r,this.type=e,this.operator=i,this.message=""}var e,n,r;return e=t,(n=[{key:"parseValue",value:function(t){var e=this.type;return"date"===e?new Date(t):"number"===e?Number(t):t}},{key:"equals",value:function(t){var e=this.type===t.type&&this.required===t.required&&this.operator===t.operator;return e&&(e=Array.isArray(this.value)?V.arrayEquals(this.value,t.value):this.value===t.value),e}},{key:"values",value:function(){return this.value.split(",")}},{key:"validate",value:function(t){var e=this.required,n=this.operator,r=this.value,i=this.type;if(e&&/^\s*$/.test(t))return ct(!1,"required");if(/^\s*$/.test(t))return[!0];if(at[i]&&!at[i].test(t))return ct(!1,"notMatch");if("list"===i)return ct(this.values().includes(t),"notIn");if(n){var o=this.parseValue(t);if("be"===n){var a=rt(r,2),c=a[0],l=a[1];return ct(o>=this.parseValue(c)&&o<=this.parseValue(l),"between",c,l)}if("nbe"===n){var u=rt(r,2),s=u[0],f=u[1];return ct(o<this.parseValue(s)||o>this.parseValue(f),"notBetween",s,f)}if("eq"===n)return ct(o===this.parseValue(r),"equal",r);if("neq"===n)return ct(o!==this.parseValue(r),"notEqual",r);if("lt"===n)return ct(o<this.parseValue(r),"lessThan",r);if("lte"===n)return ct(o<=this.parseValue(r),"lessThanEqual",r);if("gt"===n)return ct(o>this.parseValue(r),"greaterThan",r);if("gte"===n)return ct(o>=this.parseValue(r),"greaterThanEqual",r)}return[!0]}}])&&ot(e.prototype,n),r&&ot(e,r),t}();function ut(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,c=t[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return st(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return st(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function st(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ft(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ht(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function pt(t,e,n){return e&&ht(t.prototype,e),n&&ht(t,n),t}var yt=function(){function t(e,n,r){ft(this,t),this.refs=n,this.mode=e,this.validator=r}return pt(t,[{key:"includes",value:function(t,e){for(var n=this.refs,r=0;r<n.length;r+=1){if(k.valueOf(n[r]).includes(t,e))return!0}return!1}},{key:"addRef",value:function(t){this.remove(k.valueOf(t)),this.refs.push(t)}},{key:"remove",value:function(t){var e=[];this.refs.forEach((function(n){var r=k.valueOf(n);r.intersects(t)?r.difference(t).forEach((function(t){return e.push(t.toString())})):e.push(n)})),this.refs=e}},{key:"getData",value:function(){var t=this.refs,e=this.mode,n=this.validator;return{refs:t,mode:e,type:n.type,required:n.required,operator:n.operator,value:n.value}}}],[{key:"valueOf",value:function(e){var n=e.refs,r=e.mode,i=e.type,o=e.required,a=e.operator,c=e.value;return new t(r,n,new lt(i,o,c,a))}}]),t}(),dt=function(){function t(){ft(this,t),this._=[],this.errors=new Map}return pt(t,[{key:"getError",value:function(t,e){return this.errors.get("".concat(t,"_").concat(e))}},{key:"validate",value:function(t,e,n){var r=this.get(t,e),i="".concat(t,"_").concat(e),o=this.errors;if(null!==r){var a=ut(r.validator.validate(n),2),c=a[0],l=a[1];c?o.delete(i):o.set(i,l)}else o.delete(i);return!0}},{key:"add",value:function(t,e,n){var r=n.type,i=n.required,o=n.value,a=n.operator,c=new lt(r,i,o,a),l=this.getByValidator(c);null!==l?l.addRef(e):this._.push(new yt(t,[e],c))}},{key:"getByValidator",value:function(t){for(var e=0;e<this._.length;e+=1){var n=this._[e];if(n.validator.equals(t))return n}return null}},{key:"get",value:function(t,e){for(var n=0;n<this._.length;n+=1){var r=this._[n];if(r.includes(t,e))return r}return null}},{key:"remove",value:function(t){var e="".concat(t.sri,"_").concat(t.sci);this.errors.has(e)&&this.errors.delete(e),this.each((function(e){e.remove(t)}))}},{key:"each",value:function(t){this._.forEach((function(e){return t(e)}))}},{key:"getData",value:function(){return this._.filter((function(t){return t.refs.length>0})).map((function(t){return t.getData()}))}},{key:"setData",value:function(t){this._=t.map((function(t){return yt.valueOf(t)}))}}]),t}();var vt=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.keywords="",this.current=1,this.result=[]};function bt(t){return function(t){if(Array.isArray(t))return kt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||wt(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function gt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,c=t[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return n}(t,e)||wt(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wt(t,e){if(t){if("string"==typeof t)return kt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?kt(t,e):void 0}}function kt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var St={mode:"edit",updateMode:"client",updateUrl:"",view:{height:function(){return document.documentElement.clientHeight},width:function(){return document.documentElement.clientWidth}},showToolbar:!0,showContextmenu:!0,row:{len:100,height:25},col:{len:26,width:100,indexWidth:60,minWidth:60},style:{align:"left",valign:"middle",textwrap:!1,strike:!1,underline:!1,color:"#0a0a0a",font:{name:"Arial",size:10,bold:!1,italic:!1},format:"normal"}};function Ot(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},r=this.merges,i=e.clone(),o=t.size(),a=gt(o,2),c=a[0],l=a[1],u=e.size(),s=gt(u,2),f=s[0],h=s[1];return c>f&&(i.eri=e.sri+c-1),l>h&&(i.eci=e.sci+l-1),!r.intersects(i)||(n(tt("error.pasteForMergedCell")),!1)}function xt(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.rows,o=this.merges,a=this.name;"all"!==n&&"format"!==n||(i.deleteCells(e,n),o.deleteWithin(e));var c=i.copyPaste(t,e,n,r,(function(t,e,n){if(n&&n.merge){var r=gt(n.merge,2),i=r[0],a=r[1];if(i<=0&&a<=0)return;o.add(new k(t,e,t+i,e+a))}}));this.updateBatchCellsOpr(a,c)}function jt(t,e){var n=this.clipboard,r=this.rows,i=this.merges,o=this.name;r.cutPaste(t,e),i.move(t,e.sri-t.sri,e.sci-t.sci),n.clear(),this.cutPasteRangeOpr(o,t,e)}function Et(t,e,n){var r=this.styles,i=this.rows.getCellOrNew(t,e),o={};void 0!==i.style&&(o=V.cloneDeep(r[i.style])),o=V.merge(o,{border:n}),i.style=this.addStyle(o)}function Ct(t){var e=this,n=t.mode,r=t.style,i=t.color,o=this.styles,a=this.selector,c=this.rows,l=a.range,u=l.sri,s=l.sci,f=l.eri,h=l.eci,p=!this.isSignleSelected();if(p||"inside"!==n&&"horizontal"!==n&&"vertical"!==n)if("outside"!==n||p){if("none"===n)a.range.each((function(t,n){var r=c.getCell(t,n);if(r&&void 0!==r.style){var i=V.cloneDeep(o[r.style]);delete i.border,r.style=e.addStyle(i)}}));else if("all"===n||"inside"===n||"outside"===n||"horizontal"===n||"vertical"===n)!function(){for(var t=[],o=u;o<=f;o+=1)for(var a=s;a<=h;a+=1){for(var l=[],y=0;y<t.length;y+=1){var d=gt(t[y],4),v=d[0],b=d[1],m=d[2],g=d[3];if(o===v+m+1&&l.push(y),v<=o&&o<=v+m&&a===b){a+=g+1;break}}if(l.forEach((function(e){return t.splice(e,1)})),a>h)break;var w=c.getCell(o,a),k=0,S=0;if(w&&w.merge){var O=gt(w.merge,2);k=O[0],S=O[1],t.push([o,a,k,S])}var x=k>0&&o+k===f,j=S>0&&a+S===h,E={};"all"===n?E={bottom:[r,i],top:[r,i],left:[r,i],right:[r,i]}:"inside"===n?(!j&&a<h&&(E.right=[r,i]),!x&&o<f&&(E.bottom=[r,i])):"horizontal"===n?!x&&o<f&&(E.bottom=[r,i]):"vertical"===n?!j&&a<h&&(E.right=[r,i]):"outside"===n&&p&&(u===o&&(E.top=[r,i]),(x||f===o)&&(E.bottom=[r,i]),s===a&&(E.left=[r,i]),(j||h===a)&&(E.right=[r,i])),Object.keys(E).length>0&&Et.call(e,o,a,E),a+=S}}();else if("top"===n||"bottom"===n)for(var y=s;y<=h;y+=1)"top"===n&&(Et.call(this,u,y,{top:[r,i]}),y+=c.getCellMerge(u,y)[1]),"bottom"===n&&(Et.call(this,f,y,{bottom:[r,i]}),y+=c.getCellMerge(f,y)[1]);else if("left"===n||"right"===n)for(var d=u;d<=f;d+=1)"left"===n&&(Et.call(this,d,s,{left:[r,i]}),d+=c.getCellMerge(d,s)[0]),"right"===n&&(Et.call(this,d,h,{right:[r,i]}),d+=c.getCellMerge(d,h)[0])}else Et.call(this,u,s,{top:[r,i],bottom:[r,i],left:[r,i],right:[r,i]})}function Rt(t,e){var n=this.rows,r=this.scroll,i=this.freezeTotalHeight(),o=n.height,a=this.exceptRowSet;0===r.riact&&this.freeze[0]>0&&(r.riact=this.freeze[0]);var c=o+i,l=t>c?r.riact:0;0===l&&(c=o);for(var u=0;l<n.len&&!(c>t);l+=1)a.has(l)||(c+=u=n.getHeight(l));return{ri:l-1,top:c-=u,height:u}}function _t(t,e){var n=this.cols,r=this.freezeTotalWidth(),i=n.indexWidth;r+n.indexWidth<t&&(i-=e);var o=gt(V.rangeReduceIf(0,n.len,i,n.indexWidth,t,(function(t){return n.getWidth(t)})),3),a=o[0],c=o[1],l=o[2];return c<=0?{ci:-1,left:0,width:n.indexWidth}:{ci:a-1,left:c,width:l}}var At=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.settings=V.merge(St,n||{}),this.name=e||"sheet",this.freeze=[0,0],this.styles=[],this.merges=new N,this.rows=new B(this.settings.row),this.cols=new X(this.settings.col),this.validations=new dt,this.hyperlinks={},this.comments=[],this.selector=new O,this.scroll=new x,this.history=new E,this.clipboard=new R,this.autoFilter=new I,this.change=function(){},this.updateCellsData=function(){},this.updateCellServer=function(){},this.updateServerError=function(){},this.loadImages=function(){},this.loadShapes=function(){},this.loadConditionImage=function(){},this.reloadImagesShapes=function(){},this.exceptRowSet=new Set,this.sortedRowMap=new Map,this.unsortedRowMap=new Map,this.isupdating=!1,this.search=new vt,this.showGrid=!0}var e,n,r;return e=t,(n=[{key:"addValidation",value:function(t,e,n){var r=this;this.changeData((function(){r.validations.add(t,e,n)}))}},{key:"removeValidation",value:function(){var t=this,e=this.selector.range;this.changeData((function(){t.validations.remove(e)}))}},{key:"getSelectedValidator",value:function(){var t=this.selector,e=t.ri,n=t.ci,r=this.validations.get(e,n);return r?r.validator:null}},{key:"getSelectedValidation",value:function(){var t=this.selector,e=t.ri,n=t.ci,r=t.range,i=this.validations.get(e,n),o={ref:r.toString()};return null!==i&&(o.mode=i.mode,o.validator=i.validator),o}},{key:"getSelectedSort",value:function(){var t=this.selector,e=t.ci,n=t.range,r={ref:n.toString(),ci:e};r.sort=this.autoFilter.getSort(e);for(var i=[],o=n.sri,a=n.eri,c=o+1;c<=a;c+=1){var l=this.getCell(c,e);null===l||/^\s*$/.test(l.text)||i.push(l.text)}return r.m=i,r}},{key:"canUndo",value:function(){return this.history.canUndo()}},{key:"canRedo",value:function(){return this.history.canRedo()}},{key:"undo",value:function(){var t=this;this.history.undo(this.getData(),(function(e){t.setData(e)}))}},{key:"redo",value:function(){var t=this;this.history.redo(this.getData(),(function(e){t.setData(e)}))}},{key:"copy",value:function(){this.clipboard.copy(this.selector.range,this.rows)}},{key:"cut",value:function(){this.clipboard.cut(this.selector.range)}},{key:"paste",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=this.clipboard,i=this.selector;return!r.isClear()&&!!Ot.call(this,r.range,i.range,n)&&(this.changeData((function(){r.isCopy()?xt.call(t,r.range,i.range,e):r.isCut()&&jt.call(t,r.range,i.range)})),!0)}},{key:"pasteFromText",value:function(t){var e=t.split("\r\n").map((function(t){return t.replace(/"/g,"").split("\t")}));e.length>0&&(e.length-=1);var n=this.rows,r=this.selector;this.changeData((function(){n.paste(e,r.range)}))}},{key:"autofill",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=this.selector.range;return!!Ot.call(this,i,t,r)&&(this.changeData((function(){xt.call(n,i,t,e,!0)})),!0)}},{key:"clearClipboard",value:function(){this.clipboard.clear()}},{key:"calSelectedRangeByEnd",value:function(t,e){var n=this.selector,r=this.rows,i=this.cols,o=this.merges,a=n.range,c=a.sri,l=a.sci,u=a.eri,s=a.eci,f=n.ri,h=n.ci,p=t,y=e;return t<0&&(p=r.len-1),e<0&&(y=i.len-1),p>f?(c=f,u=p):(c=p,u=f),y>h?(l=h,s=y):(l=y,s=h),n.range=o.union(new k(c,l,u,s)),n.range=o.union(n.range),n.range}},{key:"calSelectedRangeByStart",value:function(t,e){var n=this.selector,r=this.rows,i=this.cols,o=this.merges.getFirstIncludes(t,e);return null===o&&(o=new k(t,e,t,e),-1===t&&(o.sri=0,o.eri=r.len-1),-1===e&&(o.sci=0,o.eci=i.len-1)),n.range=o,o}},{key:"setSelectedCellAttr",value:function(t,e){var n=this;this.changeData((function(){var r=n.selector,i=n.styles,o=n.rows;if("merge"===t)e?n.merge():n.unmerge();else if("border"===t)Ct.call(n,e);else if("formula"===t){var a=r.ri,c=r.ci,l=r.range;if(r.multiple()){var u=gt(r.size(),2),s=u[0],f=u[1],h=l.sri,p=l.sci,y=l.eri,v=l.eci;if(s>1)for(var b=p;b<=v;b+=1)o.getCellOrNew(y+1,b).text="=".concat(e,"(").concat(d(b,h),":").concat(d(b,y),")");else f>1&&(o.getCellOrNew(a,v+1).text="=".concat(e,"(").concat(d(p,a),":").concat(d(v,a),")"))}else o.getCellOrNew(a,c).text="=".concat(e,"()")}else r.range.each((function(r,a){var c=o.getCellOrNew(r,a),l={};if(void 0!==c.style&&(l=V.cloneDeep(i[c.style])),"format"===t)l.format=e,c.style=n.addStyle(l);else if("font-bold"===t||"font-italic"===t||"font-name"===t||"font-size"===t){var u={};u[t.split("-")[1]]=e,l.font=Object.assign(l.font||{},u),c.style=n.addStyle(l)}else"strike"===t||"textwrap"===t||"underline"===t||"align"===t||"valign"===t||"color"===t||"bgcolor"===t||"pbgcolor"===t||"pattern"===t?(l[t]=e,c.style=n.addStyle(l)):c[t]=e}))}))}},{key:"setSelectedCellText",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"input",n=this.autoFilter,r=this.selector,i=this.rows,o=r.ri,a=r.ci,c=o;this.unsortedRowMap.has(o)&&(c=this.unsortedRowMap.get(o));var l=i.getCell(c,a),u=l?l.text:"";if(this.setCellText(c,a,t,e),n.active()){var s=n.getFilter(a);if(s){var f=s.value.findIndex((function(t){return t===u}));f>=0&&s.value.splice(f,1,t)}}}},{key:"getSelectedCell",value:function(){var t=this.selector,e=t.ri,n=t.ci,r=e;return this.unsortedRowMap.has(e)&&(r=this.unsortedRowMap.get(e)),this.rows.getCell(r,n)}},{key:"getLocked",value:function(){if(!this.protected)return!1;var t=this.selector,e=t.ri,n=t.ci,r=e;this.unsortedRowMap.has(e)&&(r=this.unsortedRowMap.get(e));var i=this.getCellStyle(r,n);return!(null!=i&&i.unlocked)}},{key:"xyInSelectedRect",value:function(t,e){var n=this.getSelectedRect(),r=n.left,i=n.top,o=n.width,a=n.height,c=t-this.cols.indexWidth,l=e-this.rows.height;return c>r&&c<r+o&&l>i&&l<i+a}},{key:"_getSelectedRect",value:function(){return this.getRect(this.selector.range)}},{key:"getSelectedRect",value:function(){var t=this.selector.range.clone();if(this.freezeIsActive()){if(t.sri>=this.freeze[0]&&t.eri<this.scroll.riact)return{left:-100,top:-100};t.sri>=this.freeze[0]&&t.sri<this.scroll.riact&&(t.sri=this.scroll.riact)}else{if(t.eri<this.scroll.riact)return{left:-100,top:-100};t.sri<this.scroll.riact&&(t.sri=this.scroll.riact)}return this.getRect(t)}},{key:"getClipboardRect",value:function(){var t=this.clipboard;return t.isClear()?{left:-100,top:-100}:this.getRect(t.range)}},{key:"getRect",value:function(t){var e=this.scroll,n=this.rows,r=this.cols,i=this.exceptRowSet,o=t.sri,a=t.sci,c=t.eri,l=t.eci;if(o<0&&a<0)return{left:0,l:0,top:0,t:0,scroll:e};var u=r.sumWidth(0,a),s=n.sumHeight(0,o,i),f=n.sumHeight(o,c+1,i),h=r.sumWidth(a,l+1),p=u-e.x,y=this.freezeTotalHeight(),d=this.freezeTotalWidth(),v=n.sumHeight(e.riact,o,i)+y;return d>0&&d>u&&(p=u),y>0&&y>s&&(v=s),{l:u,t:s,left:p,top:v,height:f,width:h,scroll:e}}},{key:"getCellRectByXY",value:function(t,e){var n=this.scroll,r=this.merges,i=this.rows,o=this.cols,a=Rt.call(this,e,n.y),c=a.ri,l=a.top,u=a.height,s=_t.call(this,t,n.x),f=s.ci,h=s.left,p=s.width;if(-1===f&&(p=o.totalWidth()),-1===c&&(u=i.totalHeight()),c>=0||f>=0){var y=r.getFirstIncludes(c,f);if(y){c=y.sri,f=y.sci;var d=this.cellRect(c,f);h=d.left,l=d.top,p=d.width,u=d.height}}return{ri:c,ci:f,left:h,top:l,width:p,height:u}}},{key:"isSignleSelected",value:function(){var t=this.selector.range,e=t.sri,n=t.sci,r=t.eri,i=t.eci,o=this.getCell(e,n);if(o&&o.merge){var a=gt(o.merge,2),c=a[0],l=a[1];if(e+c===r&&n+l===i)return!0}return!this.selector.multiple()}},{key:"canUnmerge",value:function(){var t=this.selector.range,e=t.sri,n=t.sci,r=t.eri,i=t.eci,o=this.getCell(e,n);if(o&&o.merge){var a=gt(o.merge,2),c=a[0],l=a[1];if(e+c===r&&n+l===i)return!0}return!1}},{key:"merge",value:function(){var t=this,e=this.selector,n=this.rows;if(!this.isSignleSelected()){var r=gt(e.size(),2),i=r[0],o=r[1];if(i>1||o>1){var a=e.range,c=a.sri,l=a.sci;this.changeData((function(){var r=n.getCellOrNew(c,l);r.merge=[i-1,o-1],t.merges.add(e.range),t.rows.deleteCells(e.range),t.rows.setCell(c,l,r)}))}}}},{key:"unmerge",value:function(){var t=this,e=this.selector;if(this.isSignleSelected()){var n=e.range,r=n.sri,i=n.sci;this.changeData((function(){t.rows.deleteCell(r,i,"merge"),t.merges.deleteWithin(e.range)}))}}},{key:"canAutofilter",value:function(){return!this.autoFilter.active()}},{key:"autofilter",value:function(){var t=this,e=this.autoFilter,n=this.selector;this.changeData((function(){e.active()?(e.clear(),t.exceptRowSet=new Set,t.sortedRowMap=new Map,t.unsortedRowMap=new Map):e.ref=n.range.toString()}))}},{key:"autoSort",value:function(){var t=this.autoFilter,e=this.selector;this.changeData((function(){t.filters=[],t.ref=e.range.toString()}))}},{key:"setAutoFilter",value:function(t,e,n,r){var i=this.autoFilter;i.addFilter(t,n,r),i.setSort(t,e),this.resetAutoFilter()}},{key:"resetAutoFilter",value:function(){var t=this,e=this.autoFilter,n=this.rows;if(e.active()){var r=e.sort,i=e.filteredRows((function(t,e){return n.getCell(t,e)})),o=i.rset,a=i.fset,c=Array.from(a),l=Array.from(a);r&&c.sort((function(t,e){if("desc"===r.order){var i=t;t=e,e=i}var o=n.getCell(t,r.ci),a=n.getCell(e,r.ci);if(null!=o&&""===o.text&&(o=null),null!=a&&""===a.text&&(a=null),null==o&&null==a)return t-e;if(null==o)return"asc"===r.order?1:-1;if(null==a)return"asc"===r.order?-1:1;o=o.text,a=a.text;var c=isNaN(Number(o)),l=isNaN(Number(a));return c&&l?o.localeCompare(a):c&&!l?1:!c&&l?-1:Number(o)-Number(a)})),this.exceptRowSet=o,this.sortedRowMap=new Map,this.unsortedRowMap=new Map,c.forEach((function(e,n){t.sortedRowMap.set(l[n],e),t.unsortedRowMap.set(e,l[n])}))}}},{key:"deleteExceptRowHideForAutoFilter",value:function(){var t=this.exceptRowSet,e=this.rows;t.forEach((function(t){e.get(t)&&(e.get(t).hide=void 0)}))}},{key:"createConditionImage",value:function(t,e){var n=new Image;n.src="data:image/png;base64,"+t.data;var r=this.cols.sumWidth(0,t.col),i=this.rows.sumHeight(0,t.row);if(0===t.type){n.style.zIndex=e+1;var o=this.getCellStyle(t.row,t.col);null!=o&&"bottom"===o.valign&&(i+=this.rows.getHeight(t.row)-16)}else n.style.zIndex=e;return(this.rows.isHide(t.row)||this.cols.isHide(t.col)||this.exceptRowSet.has(t.row))&&(n.style.display="none"),n.style.left=r+"px",n.style.top=i+"px",n.style.position="absolute",n}},{key:"updateConditionImageVisible",value:function(){var t=this.exceptRowSet,e=this.rows,n=this.cols;this.conditionimg&&this.conditionimg.forEach((function(r){e.isHide(r.row)||n.isHide(r.col)||t.has(r.row)?r.image.style.display="none":r.image.style.display="block"}))}},{key:"deleteCell",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",n=this.selector;this.changeData((function(){t.rows.deleteCells(n.range,e),"all"!==e&&"format"!==e||t.merges.deleteWithin(n.range)}))}},{key:"insert",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.changeData((function(){var r=e.selector.range,i=r.sri,o=r.sci,a=e.rows,c=e.merges,l=e.cols,u=e.name,s=i;"row"===t?(a.insert(i,n),e.insertRowOpr(u,i,n)):"column"===t&&(a.insertColumn(o,n),s=o,l.len+=1,e.insertColumnOpr(u,o,n)),c.shift(t,s,n,(function(t,e,n,r){var i=a.getCell(t,e);i.merge[0]+=n,i.merge[1]+=r}))}))}},{key:"delete",value:function(t){var e=this;this.changeData((function(){var n=e.rows,r=e.merges,i=e.selector,o=e.cols,a=e.name,c=i.range,l=i.range,u=l.sri,s=l.sci,f=l.eri,h=l.eci,p=gt(i.range.size(),2),y=p[0],d=p[1],v=u,b=y;"row"===t?(n.delete(u,f),e.deleteRowOpr(a,u,f)):"column"===t&&(n.deleteColumn(s,h),v=c.sci,b=d,o.len-=1,e.deleteColumnOpr(a,s,h)),r.shift(t,v,-b,(function(t,e,r,i){var o=n.getCell(t,e);o.merge[0]+=r,o.merge[1]+=i,0===o.merge[0]&&0===o.merge[1]&&delete o.merge}))}))}},{key:"scrollx",value:function(t,e){var n=this.scroll,r=this.freeze,i=this.cols,o=gt(r,2)[1],a=gt(V.rangeReduceIf(o,i.len,0,0,t,(function(t){return i.getWidth(t)})),3),c=a[0],l=a[1],u=a[2],s=l;t>0&&(s+=u),n.x!==s&&(n.ci=t>0?c:0,n.x=s,e())}},{key:"scrolly",value:function(t,e){var n=this.scroll,r=this.freeze,i=this.rows,o=this.exceptRowSet,a=gt(r,1)[0],c=gt(V.rangeReduceIf(a,i.len,0,0,t,(function(t){return i.getHeight(t,o)})),3),l=c[0],u=c[1],s=c[2],f=u;if(t>0&&(f+=s),n.y!==f){for(n.ri=t>0?l:0,n.y=f,0===n.ri&&this.freeze[0]>0&&(n.ri=this.freeze[0],n.y=0),n.yact=n.y,n.riact=n.ri;this.isInvisibleRow(n.riact);)n.yact+=i.getHeight(n.riact,o),n.riact++;e()}}},{key:"isInvisibleRow",value:function(t){var e=this.exceptRowSet;return this.rows.isHide(t)||e.has(t)}},{key:"cellRect",value:function(t,e){var n=this.rows,r=this.cols,i=this.exceptRowSet,o=r.sumWidth(0,e),a=n.sumHeight(0,t,i),c=n.getCell(t,e),l=r.getWidth(e),u=n.getHeight(t);if(null!==c&&c.merge){var s=gt(c.merge,2),f=s[0],h=s[1];if(f>0)for(var p=1;p<=f;p+=1)u+=n.getHeight(t+p);if(h>0)for(var y=1;y<=h;y+=1)l+=r.getWidth(e+y)}return{left:o,top:a,width:l,height:u,cell:c}}},{key:"getCell",value:function(t,e){return this.rows.getCell(t,e)}},{key:"getCellTextOrDefault",value:function(t,e){var n=this.getCell(t,e);return n&&n.text?n.text:""}},{key:"getCellStyle",value:function(t,e){var n=this.getCell(t,e);return n&&void 0!==n.style?this.styles[n.style]:null}},{key:"getCellStyleOrDefault",value:function(t,e){var n=this.styles,r=this.rows,i=r.getCell(t,e),o=i&&void 0!==i.style?n[i.style]:{},a=V.merge(this.defaultStyle(),o);if(void 0!==o.bgcolor&&(a.hasbgcolor=!0),i&&void 0!==i.merge){if(0!=i.merge[1]){var c=r.getCell(t,e+i.merge[1]),l=c&&void 0!==c.style?n[c.style]:{};l.border&&void 0!==l.border.right&&(void 0===o.border&&(o.border={}),o.border.right=l.border.right)}if(0!=i.merge[0]){var u=r.getCell(t+i.merge[0],e),s=u&&void 0!==u.style?n[u.style]:{};s.border&&void 0!==s.border.bottom&&(void 0===o.border&&(o.border={}),o.border.bottom=s.border.bottom)}}return a}},{key:"getSelectedCellStyle",value:function(){var t=this.selector,e=t.ri,n=t.ci;return this.getCellStyleOrDefault(e,n)}},{key:"setCellText",value:function(t,e,n,r){var i=this.rows,o=this.history,a=this.validations,c=(this.settings,this.name);"finished"===r?(i.setCellText(t,e,""),o.add(this.getData()),i.setCellText(t,e,n),this.updateCellTextOpr(c,t,e,n)):(i.setCellText(t,e,n),this.change(this.getData())),a.validate(t,e,n)}},{key:"cutPasteRangeOpr",value:function(t,e,n){var r={name:t,src:e,dest:n,op:"cutpaste"};this.updateCellServer(r)}},{key:"updateBatchCellsOpr",value:function(t,e){var n={name:t,cells:e,op:"batchupdate"};this.updateCellServer(n)}},{key:"updateCellTextOpr",value:function(t,e,n,r){var i={name:t,ri:e,ci:n,text:r,op:"update"};this.updateCellServer(i)}},{key:"addSheetOpr",value:function(t){var e={name:t,op:"add"};this.updateCellServer(e)}},{key:"delSheetOpr",value:function(t){var e={name:t,op:"del"};this.updateCellServer(e)}},{key:"insertRowOpr",value:function(t,e,n){var r={name:t,ri:e,n:n,op:"insertrow"};this.updateCellServer(r)}},{key:"insertColumnOpr",value:function(t,e,n){var r={name:t,ci:e,n:n,op:"insertcol"};this.updateCellServer(r)}},{key:"deleteRowOpr",value:function(t,e,n){var r={name:t,sri:e,eri:n,op:"delrow"};this.updateCellServer(r)}},{key:"deleteColumnOpr",value:function(t,e,n){var r={name:t,sci:e,eci:n,op:"delcol"};this.updateCellServer(r)}},{key:"updateMyCells",value:function(t){var e=this.rows;t.forEach((function(t,n,r){e.setCellText(t.ri,t.ci,t.text)}))}},{key:"updateShapes",value:function(t){var e=this.shapes;null!=e&&null!=t&&t.forEach((function(t,n,r){for(var i=0,o=e.length;i<o;i++)if(e[i].id===t.id){e[i].tick=t.tick,e[i].updating=!0;break}}))}},{key:"updateShapeSrcToRefresh",value:function(){var t=this.shapes;null!=t&&t.forEach((function(t){if(t.updating){t.updating=void 0;var e=$("#s_"+t.id)[0].src,n=e.lastIndexOf("&"),r=e.substr(0,n)+"&id="+t.id+"."+t.tick;$("#s_"+t.id).attr("src",r)}}))}},{key:"validateFormula",value:function(t){for(var e=0,n=0;n<t.length;n++)"("===t[n]?e++:")"===t[n]&&e--;return 0===e}},{key:"freezeIsActive",value:function(){var t=gt(this.freeze,2),e=t[0],n=t[1];return e>0||n>0}},{key:"setFreeze",value:function(t,e){var n=this;this.changeData((function(){n.freeze=[t,e]}))}},{key:"freezeTotalWidth",value:function(){return this.cols.sumWidth(0,this.freeze[1])}},{key:"freezeTotalHeight",value:function(){return this.rows.sumHeight(0,this.freeze[0],this.exceptRowSet)}},{key:"setRowHeight",value:function(t,e){var n=this;this.changeData((function(){n.rows.setHeight(t,e)}))}},{key:"setColWidth",value:function(t,e){var n=this;this.changeData((function(){n.cols.setWidth(t,e)}))}},{key:"viewHeight",value:function(){var t=this.settings,e=t.view,n=t.showToolbar,r=e.height();return r-=41,n&&(r-=41),r}},{key:"viewWidth",value:function(){return this.settings.view.width()}},{key:"freezeViewRange",value:function(){var t=gt(this.freeze,2),e=t[0],n=t[1];return new k(0,0,e-1,n-1,this.freezeTotalWidth(),this.freezeTotalHeight())}},{key:"contentRange",value:function(){var t=this.rows,e=this.cols,n=gt(t.maxCell(),2),r=n[0],i=n[1],o=t.sumHeight(0,r+1),a=e.sumWidth(0,i+1);return new k(0,0,r,i,a,o)}},{key:"exceptRowTotalHeight",value:function(t,e){var n=this.exceptRowSet,r=this.rows,i=Array.from(n),o=0;return i.forEach((function(n){if(n<t||n>e){var i=r.getHeight(n);o+=i}})),o}},{key:"viewRange",value:function(){var t=this.scroll,e=this.rows,n=this.cols,r=this.freeze,i=this.exceptRowSet,o=t.ri,a=t.ci;o<=0&&(o=gt(r,1)[0]),a<=0&&(a=gt(r,2)[1]);for(var c=0,l=0,u=[e.len,n.len],s=u[0],f=u[1],h=o;h<e.len&&(i.has(h)||(l+=e.getHeight(h),s=h),!(l>this.viewHeight()));h+=1);for(var p=a;p<n.len&&(f=p,!((c+=n.getWidth(p))>this.viewWidth()));p+=1);return new k(o,a,s,f,c,l)}},{key:"eachMergesInView",value:function(t,e){this.merges.filterIntersects(t).forEach((function(t){return e(t)}))}},{key:"hideRowsOrCols",value:function(){var t=this.rows,e=this.cols,n=this.selector,r=gt(n.size(),2),i=r[0],o=r[1],a=n.range,c=a.sri,l=a.sci,u=a.eri,s=a.eci;if(i===t.len)for(var f=l;f<=s;f+=1)e.setHide(f,!0);else if(o===e.len)for(var h=c;h<=u;h+=1)t.setHide(h,!0)}},{key:"unhideRowsOrCols",value:function(t,e){this["".concat(t,"s")].unhide(e)}},{key:"rowEach",value:function(t,e,n){for(var r=0,i=this.rows,o=this.exceptRowSet,a=(bt(o),0),c=t+a;c<=e;c+=1)if(o.has(c))a+=1;else{var l=i.getHeight(c);if(l>0&&(n(c,r,l),(r+=l)>this.viewHeight()))break}}},{key:"colEach",value:function(t,e,n){for(var r=0,i=this.cols,o=t;o<=e;o+=1){var a=i.getWidth(o);if(a>0&&(n(o,r,a),(r+=a)>this.viewWidth()))break}}},{key:"defaultStyle",value:function(){return this.settings.style}},{key:"addStyle",value:function(t){for(var e=this.styles,n=0;n<e.length;n+=1){var r=e[n];if(V.equals(r,t))return n}return e.push(t),e.length-1}},{key:"changeData",value:function(t){this.history.add(this.getData()),t(),this.change(this.getData())}},{key:"setData",value:function(t){var e=this;return Object.keys(t).forEach((function(n){if("merges"===n||"rows"===n||"cols"===n||"validations"===n)e[n].setData(t[n]);else if("freeze"===n){var r=gt(y(t[n]),2),i=r[0],o=r[1];e.freeze=[o,i]}else"autofilter"===n?e.autoFilter.setData(t[n]):void 0!==t[n]&&(e[n]=t[n])})),this}},{key:"getData",value:function(){var t=this.name,e=this.freeze,n=this.styles,r=this.merges,i=this.rows,o=this.cols,a=this.validations,c=this.autoFilter;return{name:t,freeze:d(e[1],e[0]),styles:n,merges:r.getData(),rows:i.getData(),cols:o.getData(),validations:a.getData(),autofilter:c.getData()}}}])&&mt(e.prototype,n),r&&mt(e,r),t}();function Pt(t,e,n){t.addEventListener(e,n)}function Tt(t,e,n){t.removeEventListener(e,n)}function Dt(t){t.xclickoutside&&(Tt(window.document.body,"click",t.xclickoutside),delete t.xclickoutside)}function It(t,e){t.xclickoutside=function(n){2===n.detail||t.contains(n.target)||(e?e(t):(t.hide(),Dt(t)))},Pt(window.document.body,"click",t.xclickoutside)}function zt(t,e,n){Pt(t,"mousemove",e),t.xEvtUp=function(r){Tt(t,"mousemove",e),Tt(t,"mouseup",t.xEvtUp),n(r)},Pt(t,"mouseup",t.xEvtUp)}function Mt(t,e,n,r){Math.abs(t)>Math.abs(e)?r(t>0?"right":"left",t,n):r(e>0?"down":"up",e,n)}var Nt="x-spreadsheet";window.devicePixelRatio;function Ht(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ft(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Wt=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=arguments.length>1?arguments[1]:void 0;Ht(this,t),this.moving=!1,this.vertical=n,this.el=l("div","".concat(Nt,"-resizer ").concat(n?"vertical":"horizontal")).children(this.unhideHoverEl=l("div","".concat(Nt,"-resizer-hover")).on("dblclick.stop",(function(t){return e.mousedblclickHandler(t)})).css("position","absolute").hide(),this.hoverEl=l("div","".concat(Nt,"-resizer-hover")).on("mousedown.stop",(function(t){return e.mousedownHandler(t)})),this.lineEl=l("div","".concat(Nt,"-resizer-line")).hide()).hide(),this.cRect=null,this.finishedFn=null,this.minDistance=r,this.unhideFn=function(){}}var e,n,r;return e=t,(n=[{key:"showUnhide",value:function(t){this.unhideIndex=t,this.unhideHoverEl.show()}},{key:"hideUnhide",value:function(){this.unhideHoverEl.hide()}},{key:"show",value:function(t,e){var n=this.moving,r=this.vertical,i=this.hoverEl,o=this.lineEl,a=this.el,c=this.unhideHoverEl;if(!n){this.cRect=t;var l=t.left,u=t.top,s=t.width,f=t.height;a.offset({left:r?l+s-5:l,top:r?u:u+f-5}).show(),i.offset({width:r?5:s,height:r?f:5}),o.offset({width:r?0:e.width,height:r?e.height:0}),c.offset({left:r?5-s:l,top:r?u:5-f,width:r?5:s,height:r?f:5})}}},{key:"hide",value:function(){this.el.offset({left:0,top:0}).hide(),this.hideUnhide()}},{key:"mousedblclickHandler",value:function(){this.unhideIndex&&this.unhideFn(this.unhideIndex)}},{key:"mousedownHandler",value:function(t){var e=this,n=t,r=this.el,i=this.lineEl,o=this.cRect,a=this.vertical,c=this.minDistance,l=a?o.width:o.height;i.show(),zt(window,(function(t){e.moving=!0,null!==n&&1===t.buttons&&(a?(l+=t.movementX)>c&&r.css("left","".concat(o.left+l,"px")):(l+=t.movementY)>c&&r.css("top","".concat(o.top+l,"px")),n=t)}),(function(){n=null,i.hide(),e.moving=!1,e.hide(),e.finishedFn&&(l<c&&(l=c),e.finishedFn(o,l))}))}}])&&Ft(e.prototype,n),r&&Ft(e,r),t}();function Vt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ut=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.vertical=e,this.moveFn=null,this.el=l("div","".concat(Nt,"-scrollbar ").concat(e?"vertical":"horizontal")).child(this.contentEl=l("div","")).on("mousemove.stop",(function(){})).on("scroll.stop",(function(t){var e=t.target,r=e.scrollTop,i=e.scrollLeft;n.moveFn&&n.moveFn(n.vertical?r:i,t)}))}var e,n,r;return e=t,(n=[{key:"move",value:function(t){return this.el.scroll(t),this}},{key:"scroll",value:function(){return this.el.scroll()}},{key:"set",value:function(t,e){var n=t-1;if(e>n){var r=this.vertical?"height":"width";this.el.css(r,"".concat(n-15,"px")).show(),this.contentEl.css(this.vertical?"width":"height","1px").css(r,"".concat(e,"px"))}else this.el.hide();return this}}])&&Vt(e.prototype,n),r&&Vt(e,r),t}();function qt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Lt(t,e,n){return e&&$t(t.prototype,e),n&&$t(t,n),t}var Bt=10,Yt=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];qt(this,t),this.useHideInput=n,this.inputChange=function(){},this.cornerEl=l("div","".concat(Nt,"-selector-corner")),this.areaEl=l("div","".concat(Nt,"-selector-area")).child(this.cornerEl).hide(),this.clipboardEl=l("div","".concat(Nt,"-selector-clipboard")).hide(),this.autofillEl=l("div","".concat(Nt,"-selector-autofill")).hide(),this.el=l("div","".concat(Nt,"-selector")).css("z-index","".concat(Bt)).children(this.areaEl,this.clipboardEl,this.autofillEl).hide(),n&&(this.hideInput=l("input","").on("compositionend",(function(t){e.inputChange(t.target.value)})),this.el.child(this.hideInputDiv=l("div","hide-input").child(this.hideInput)),this.el.child(this.hideInputDiv=l("div","hide-input").child(this.hideInput))),Bt+=1}return Lt(t,[{key:"setOffset",value:function(t){return this.el.offset(t).show(),this}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"setAreaOffset",value:function(t){var e=t.left,n=t.top,r={width:t.width+.8,height:t.height+.8,left:e-.8,top:n-.8};this.areaEl.offset(r).show(),this.useHideInput&&(this.hideInputDiv.offset(r),this.hideInput.val("").focus())}},{key:"setClipboardOffset",value:function(t){var e=t.left,n=t.top,r=t.width,i=t.height;this.clipboardEl.offset({left:e,top:n,width:r-5,height:i-5})}},{key:"showAutofill",value:function(t){var e=t.left,n=t.top,r=t.width,i=t.height;this.autofillEl.offset({width:r-3,height:i-3,left:e,top:n}).show()}},{key:"hideAutofill",value:function(){this.autofillEl.hide()}},{key:"showClipboard",value:function(){this.clipboardEl.show()}},{key:"hideClipboard",value:function(){this.clipboardEl.hide()}}]),t}();function Xt(t){var e=this.data,n=t.left,r=t.top,i=t.width,o=t.height,a=t.scroll,c=t.l,l=t.t,u=e.freezeTotalWidth(),s=e.freezeTotalHeight(),f=n-u;u>c&&(f-=a.x);var h=r-s;return s>l&&(h-=a.y),{left:f,top:h,width:i,height:o}}function Zt(t){var e=this.data,n=t.left,r=t.width,i=t.height,o=t.l,a=t.t,c=t.scroll,l=e.freezeTotalWidth(),u=n-l;return l>o&&(u-=c.x),{left:u,top:a,width:r,height:i}}function Kt(t){var e=this.data,n=t.top,r=t.width,i=t.height,o=t.l,a=t.t,c=t.scroll,l=e.freezeTotalHeight(),u=n-l;return l>a&&(u-=c.y),{left:o,top:u,width:r,height:i}}function Jt(t){this.br.setAreaOffset(Xt.call(this,t))}function Gt(t){this.tl.setAreaOffset(t)}function Qt(t){this.t.setAreaOffset(Zt.call(this,t))}function te(t){this.l.setAreaOffset(Kt.call(this,t))}function ee(t){this.l.setClipboardOffset(Kt.call(this,t))}function ne(t){this.br.setClipboardOffset(Xt.call(this,t))}function re(t){this.tl.setClipboardOffset(t)}function ie(t){this.t.setClipboardOffset(Zt.call(this,t))}function oe(t){Jt.call(this,t),Gt.call(this,t),Qt.call(this,t),te.call(this,t)}function ae(t){ne.call(this,t),re.call(this,t),ie.call(this,t),ee.call(this,t)}var ce=function(){function t(e){var n=this;qt(this,t),this.inputChange=function(){},this.data=e,this.br=new Yt(!0),this.t=new Yt,this.l=new Yt,this.tl=new Yt,this.br.inputChange=function(t){n.inputChange(t)},this.br.el.show(),this.offset=null,this.areaOffset=null,this.indexes=null,this.range=null,this.arange=null,this.el=l("div","".concat(Nt,"-selectors")).children(this.tl.el,this.t.el,this.l.el,this.br.el).hide(),this.lastri=-1,this.lastci=-1,Bt+=1}return Lt(t,[{key:"resetData",value:function(t){this.data=t,this.range=t.selector.range,this.resetAreaOffset()}},{key:"hide",value:function(){this.el.hide()}},{key:"resetOffset",value:function(){var t=this.data,e=this.tl,n=this.t,r=this.l,i=this.br,o=t.freezeTotalHeight(),a=t.freezeTotalWidth();o>0||a>0?(e.setOffset({width:a,height:o}),n.setOffset({left:a,height:o}),r.setOffset({top:o,width:a}),i.setOffset({left:a,top:o})):(e.hide(),n.hide(),r.hide(),i.setOffset({left:0,top:0}))}},{key:"resetAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();oe.call(this,t),ae.call(this,e),this.resetOffset()}},{key:"resetBRTAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();Jt.call(this,t),Qt.call(this,t),ne.call(this,e),ie.call(this,e),this.resetOffset()}},{key:"resetBRLAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();Jt.call(this,t),te.call(this,t),ne.call(this,e),ee.call(this,e),this.resetOffset()}},{key:"set",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this.data,i=r.calSelectedRangeByStart(t,e),o=i.sri,a=i.sci;if(n){var c=t,l=e;t<0&&(c=0),e<0&&(l=0),r.selector.setIndexes(c,l),this.indexes=[c,l]}this.moveIndexes=[o,a],this.range=i,this.resetAreaOffset(),this.el.show()}},{key:"setEnd",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this.data,i=this.lastri,o=this.lastci;if(n){if(t===i&&e===o)return;this.lastri=t,this.lastci=e}this.range=r.calSelectedRangeByEnd(t,e),oe.call(this,this.data.getSelectedRect())}},{key:"reset",value:function(){var t=this.data.selector.range,e=t.eri,n=t.eci;this.setEnd(e,n)}},{key:"showAutofill",value:function(t,e){if(-1!==t||-1!==e){var n=this.range,r=n.sri,i=n.sci,o=n.eri,a=n.eci,c=t,l=e,u=r-t,s=o-t,f=a-e;if(i-e>0)this.arange=new k(r,l,o,i-1);else if(u>0)this.arange=new k(c,i,r-1,a);else if(f<0)this.arange=new k(r,a+1,o,l);else{if(!(s<0))return void(this.arange=null);this.arange=new k(o+1,i,c,a)}if(null!==this.arange){var h=this.data.getRect(this.arange);h.width+=2,h.height+=2;var p=this.br,y=this.l,d=this.t,v=this.tl;p.showAutofill(Xt.call(this,h)),y.showAutofill(Kt.call(this,h)),d.showAutofill(Zt.call(this,h)),v.showAutofill(h)}}}},{key:"hideAutofill",value:function(){var t=this;["br","l","t","tl"].forEach((function(e){t[e].hideAutofill()}))}},{key:"showClipboard",value:function(){var t=this,e=this.data.getClipboardRect();ae.call(this,e),["br","l","t","tl"].forEach((function(e){t[e].showClipboard()}))}},{key:"hideClipboard",value:function(){var t=this;["br","l","t","tl"].forEach((function(e){t[e].hideClipboard()}))}}]),t}();function le(t){return function(t){if(Array.isArray(t))return ue(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return ue(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ue(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ue(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function se(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function he(t){t.preventDefault(),t.stopPropagation();var e=this.filterItems;e.length<=0||(this.itemIndex>=0&&e[this.itemIndex].toggle(),this.itemIndex-=1,this.itemIndex<0&&(this.itemIndex=e.length-1),e[this.itemIndex].toggle())}function pe(t){t.stopPropagation();var e=this.filterItems;e.length<=0||(this.itemIndex>=0&&e[this.itemIndex].toggle(),this.itemIndex+=1,this.itemIndex>e.length-1&&(this.itemIndex=0),e[this.itemIndex].toggle())}function ye(t){t.preventDefault();var e=this.filterItems;e.length<=0||(t.stopPropagation(),this.itemIndex<0&&(this.itemIndex=0),e[this.itemIndex].el.click(),this.hide())}function de(t){var e=t.keyCode;switch(t.ctrlKey&&t.stopPropagation(),e){case 37:t.stopPropagation();break;case 38:he.call(this,t);break;case 39:t.stopPropagation();break;case 40:pe.call(this,t);break;case 13:case 9:ye.call(this,t);break;default:t.stopPropagation()}}var ve=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"200px";se(this,t),this.filterItems=[],this.items=e,this.el=l("div","".concat(Nt,"-suggest")).css("width",r).hide(),this.itemClick=n,this.itemIndex=-1}var e,n,r;return e=t,(n=[{key:"setOffset",value:function(t){this.el.cssRemoveKeys("top","bottom").offset(t)}},{key:"hide",value:function(){var t=this.el;this.filterItems=[],this.itemIndex=-1,t.hide(),Dt(this.el.parent())}},{key:"setItems",value:function(t){this.items=t}},{key:"search",value:function(t){var e,n=this,r=this.items;if(/^\s*$/.test(t)||(r=r.filter((function(e){return(e.key||e).startsWith(t.toUpperCase())}))),r=r.map((function(t){var e=t.title;e?"function"==typeof e&&(e=e()):e=t;var r=l("div","".concat(Nt,"-item")).child(e).on("click.stop",(function(){n.itemClick(t),n.hide()}));return t.label&&r.child(l("div","label").html(t.label)),r})),this.filterItems=r,!(r.length<=0)){var i=this.el;(e=i.html("")).children.apply(e,le(r)).show(),It(i.parent(),(function(){n.hide()}))}}},{key:"bindInputEvents",value:function(t){var e=this;t.on("keydown",(function(t){return de.call(e,t)}))}}])&&fe(e.prototype,n),r&&fe(e,r),t}();function be(t){return(be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function me(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ge(t,e){return(ge=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function we(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Se(t);if(e){var i=Se(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ke(this,n)}}function ke(t,e){return!e||"object"!==be(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Se(t){return(Se=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Oe=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ge(t,e)}(o,t);var e,n,r,i=we(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this,"div","".concat(Nt,"-icon"))).iconNameEl=l("div","".concat(Nt,"-icon-img ").concat(t)),e.child(e.iconNameEl),e}return e=o,(n=[{key:"setName",value:function(t){this.iconNameEl.className("".concat(Nt,"-icon-img ").concat(t))}}])&&me(e.prototype,n),r&&me(e,r),o}(c);function xe(t){return function(t){if(Array.isArray(t))return je(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return je(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return je(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function je(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Ee(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ce(t,e){t.setMonth(t.getMonth()+e)}function Re(t,e){var n=new Date(t);return n.setDate(e-t.getDay()+1),n}var _e=function(){function t(e){var n,r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.value=e,this.cvalue=new Date(e),this.headerLeftEl=l("div","calendar-header-left"),this.bodyEl=l("tbody",""),this.buildAll(),this.el=l("div","x-spreadsheet-calendar").children(l("div","calendar-header").children(this.headerLeftEl,l("div","calendar-header-right").children(l("a","calendar-prev").on("click.stop",(function(){return r.prev()})).child(new Oe("chevron-left")),l("a","calendar-next").on("click.stop",(function(){return r.next()})).child(new Oe("chevron-right")))),l("table","calendar-body").children(l("thead","").child((n=l("tr","")).children.apply(n,xe(tt("calendar.weeks").map((function(t){return l("th","cell").child(t)}))))),this.bodyEl)),this.selectChange=function(){}}var e,n,r;return e=t,(n=[{key:"setValue",value:function(t){this.value=t,this.cvalue=new Date(t),this.buildAll()}},{key:"prev",value:function(){Ce(this.value,-1),this.buildAll()}},{key:"next",value:function(){Ce(this.value,1),this.buildAll()}},{key:"buildAll",value:function(){this.buildHeaderLeft(),this.buildBody()}},{key:"buildHeaderLeft",value:function(){var t=this.value;this.headerLeftEl.html("".concat(tt("calendar.months")[t.getMonth()]," ").concat(t.getFullYear()))}},{key:"buildBody",value:function(){var t,e=this,n=this.value,r=this.cvalue,i=this.bodyEl,o=function(t,e,n){for(var r=new Date(t,e,1,23,59,59),i=[[],[],[],[],[],[]],o=0;o<6;o+=1)for(var a=0;a<7;a+=1){var c=Re(r,7*o+a),l=c.getMonth()!==e,u=c.getMonth()===n.getMonth()&&c.getDate()===n.getDate();i[o][a]={d:c,disabled:l,active:u}}return i}(n.getFullYear(),n.getMonth(),r).map((function(t){var n,r=t.map((function(t){var n="cell";return t.disabled&&(n+=" disabled"),t.active&&(n+=" active"),l("td","").child(l("div",n).on("click.stop",(function(){e.selectChange(t.d)})).child(t.d.getDate().toString()))}));return(n=l("tr","")).children.apply(n,xe(r))}));(t=i.html("")).children.apply(t,xe(o))}}])&&Ee(e.prototype,n),r&&Ee(e,r),t}();function Ae(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Pe=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.calendar=new _e(new Date),this.el=l("div","".concat(Nt,"-datepicker")).child(this.calendar.el).hide()}var e,n,r;return e=t,(n=[{key:"setValue",value:function(t){var e=this.calendar;return"string"==typeof t?/^\d{4}-\d{1,2}-\d{1,2}$/.test(t)&&e.setValue(new Date(t.replace(new RegExp("-","g"),"/"))):t instanceof Date&&e.setValue(t),this}},{key:"change",value:function(t){var e=this;this.calendar.selectChange=function(n){t(n),e.hide()}}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide()}}])&&Ae(e.prototype,n),r&&Ae(e,r),t}();function Te(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function De(t){return function(t){if(Array.isArray(t))return Ie(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Ie(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ie(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ie(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ze(){var t=this.inputText;if(!/^\s*$/.test(t)){var e=this.textlineEl,n=this.textEl,r=this.areaOffset,i=t.split("\n"),o=Math.max.apply(Math,De(i.map((function(t){return t.length})))),a=e.offset().width/t.length,c=(o+1)*a+5,l=this.viewFn().width-r.left-a,u=i.length;if(c>r.width){var s=c;c>l&&(s=l,u+=parseInt(c/l,10),u+=c%l>0?1:0),n.css("width","".concat(s,"px"))}(u*=this.rowHeight)>r.height&&n.css("height","".concat(u,"px"))}}function Me(t,e){var n=t.target,r=n.value,i=n.selectionEnd,o="".concat(r.slice(0,i)).concat(e).concat(r.slice(i));n.value=o,n.setSelectionRange(i+1,i+1),this.inputText=o,this.textlineEl.html(o),ze.call(this)}function Ne(t){var e=t.keyCode,n=t.altKey;13!==e&&9!==e&&t.stopPropagation(),13===e&&n&&(Me.call(this,t,"\n"),t.stopPropagation()),13!==e||n||t.preventDefault()}function He(t){var e=t.target.value,n=this.suggest,r=this.textlineEl,i=this.validator,o=this.cell;if(null!==o)if("editable"in o&&!0===o.editable||void 0===o.editable){if(this.inputText=e,i)"list"===i.type?n.search(e):n.hide();else{var a=e.lastIndexOf("=");-1!==a?n.search(e.substring(a+1)):n.hide()}r.html(e),ze.call(this),this.change("input",e)}else t.target.value="";else{if(this.inputText=e,i)"list"===i.type?n.search(e):n.hide();else{var c=e.lastIndexOf("=");-1!==c?n.search(e.substring(c+1)):n.hide()}r.html(e),ze.call(this),this.change("input",e)}}function Fe(t){var e=this.textEl.el;setTimeout((function(){e.focus(),e.setSelectionRange(t,t)}),0)}function We(t,e){var n=this.textEl,r=this.textlineEl;n.el.blur(),n.val(t),r.html(t),Fe.call(this,e)}function Ve(t){var e=this.inputText,n=this.validator,r=0;if(n&&"list"===n.type)this.inputText=t,r=this.inputText.length;else{var i=e.lastIndexOf("="),o=e.substring(0,i+1),a=e.substring(i+1);a=-1!==a.indexOf(")")?a.substring(a.indexOf(")")):"",this.inputText="".concat(o+t.key,"("),r=this.inputText.length,this.inputText+=")".concat(a)}We.call(this,this.inputText,r)}function Ue(){this.suggest.setItems(this.formulas)}var qe=function(){function t(e,n,r){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.viewFn=n,this.rowHeight=r,this.formulas=e,this.suggest=new ve(e,(function(t){Ve.call(i,t)})),this.datepicker=new Pe,this.datepicker.change((function(t){i.setText(function(t){var e=t.getMonth()+1,n=t.getDate();return e<10&&(e="0".concat(e)),n<10&&(n="0".concat(n)),"".concat(t.getFullYear(),"-").concat(e,"-").concat(n)}(t)),i.clear()})),this.areaEl=l("div","".concat(Nt,"-editor-area")).children(this.textEl=l("textarea","").on("input",(function(t){return He.call(i,t)})).on("paste.stop",(function(){})).on("keydown",(function(t){return Ne.call(i,t)})),this.textlineEl=l("div","textline"),this.suggest.el,this.datepicker.el).on("mousemove.stop",(function(){})).on("mousedown.stop",(function(){})),this.el=l("div","".concat(Nt,"-editor")).child(this.areaEl).hide(),this.suggest.bindInputEvents(this.textEl),this.areaOffset=null,this.freeze={w:0,h:0},this.cell=null,this.inputText="",this.change=function(){}}var e,n,r;return e=t,(n=[{key:"setFreezeLengths",value:function(t,e){this.freeze.w=t,this.freeze.h=e}},{key:"clear",value:function(){""!==this.inputText&&this.change("finished",this.inputText),this.cell=null,this.areaOffset=null,this.inputText="",this.el.hide(),this.textEl.val(""),this.textlineEl.html(""),Ue.call(this),this.datepicker.hide()}},{key:"setOffset",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top",n=this.textEl,r=this.areaEl,i=this.suggest,o=this.freeze,a=this.el;if(t){this.areaOffset=t;var c=t.left,l=t.top,u=t.width,s=t.height,f=t.l,h=t.t,p={left:0,top:0};o.w>f&&o.h>h||(o.w<f&&o.h<h?(p.left=o.w,p.top=o.h):o.w>f?p.top=o.h:o.h>h&&(p.left=o.w)),a.offset(p),r.offset({left:c-p.left-.8,top:l-p.top-.8}),n.offset({width:u-9+.8,height:s-3+.8});var y={left:0};y[e]=s,i.setOffset(y),i.hide()}}},{key:"setCell",value:function(t,e){var n=this.el,r=this.datepicker,i=this.suggest;n.show(),this.cell=t;var o=t&&t.text||"";if(t&&(t.f?o=t.f:t.ufv&&(o=t.ufv)),this.setText(o),this.validator=e,e){var a=e.type;"date"===a&&(r.show(),/^\s*$/.test(o)||r.setValue(o)),"list"===a&&(i.setItems(e.values()),i.search(""))}}},{key:"setText",value:function(t){this.inputText=t,We.call(this,t,t.length),ze.call(this)}}])&&Te(e.prototype,n),r&&Te(e,r),t}();function $e(t){return($e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Le(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Be(t,e){return(Be=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ye(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ze(t);if(e){var i=Ze(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Xe(this,n)}}function Xe(t,e){return!e||"object"!==$e(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ze(t){return(Ze=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ke=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Be(t,e)}(n,t);var e=Ye(n);function n(t){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Le(this,n),(r=e.call(this,"div","".concat(Nt,"-button ").concat(i))).child(tt("button.".concat(t))),r}return n}(c);function Je(t){return function(t){if(Array.isArray(t))return tn(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||Qe(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ge(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,c=t[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return n}(t,e)||Qe(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Qe(t,e){if(t){if("string"==typeof t)return tn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?tn(t,e):void 0}}function tn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function en(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function nn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function rn(t,e,n){return e&&nn(t.prototype,e),n&&nn(t,n),t}function on(){return window.devicePixelRatio||1}function an(){return on()-.5}function cn(t){return parseInt(t*on(),10)}function ln(t){var e=cn(t);return e>0?e-.5:.5}var un=function(){function t(e,n,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;en(this,t),this.x=e,this.y=n,this.width=r,this.height=i,this.padding=o,this.bgcolor="#ffffff",this.borderTop=null,this.borderRight=null,this.borderBottom=null,this.borderLeft=null,this.pbgcolor=null,this.pattern=null}return rn(t,[{key:"setBorders",value:function(t){var e=t.top,n=t.bottom,r=t.left,i=t.right;e&&(this.borderTop=e),i&&(this.borderRight=i),n&&(this.borderBottom=n),r&&(this.borderLeft=r)}},{key:"setPattern",value:function(t){t&&(this.pattern=t)}},{key:"innerWidth",value:function(){return this.width-2*this.padding-2}},{key:"innerHeight",value:function(){return this.height-2*this.padding-2}},{key:"textx",value:function(t){var e=this.width,n=this.padding,r=this.x;return"left"===t?r+=n:"center"===t?r+=e/2:"right"===t&&(r+=e-n),r}},{key:"texty",value:function(t,e){var n=this.height,r=this.padding,i=this.y;return"top"===t?i+=r:"middle"===t?i+=n/2-e/2:"bottom"===t&&(i+=n-r-e),i}},{key:"topxys",value:function(){var t=this.x,e=this.y;return[[t,e],[t+this.width,e]]}},{key:"rightxys",value:function(){var t=this.x,e=this.y,n=this.width;return[[t+n,e],[t+n,e+this.height]]}},{key:"bottomxys",value:function(){var t=this.x,e=this.y,n=this.width,r=this.height;return[[t,e+r],[t+n,e+r]]}},{key:"leftxys",value:function(){var t=this.x,e=this.y;return[[t,e],[t,e+this.height]]}}]),t}();function sn(t,e,n,r,i,o,a){var c={x:0,y:0};"underline"===t?c.y="bottom"===i?0:"top"===i?-(o+2):-o/2:"strike"===t&&("bottom"===i?c.y=o/2:"top"===i&&(c.y=-(o/2+2))),"center"===r?c.x=a/2:"right"===r&&(c.x=a),this.line([e-c.x,n-c.y],[e-c.x+a,n-c.y])}function fn(t,e,n,r,i,o){for(var a=n;a<i;a+=o)t.moveTo(e,a),t.lineTo(r,a)}function hn(t,e,n,r,i,o){for(var a=e;a<r;a+=o)t.moveTo(a,n),t.lineTo(a,i)}function pn(t,e,n,r,i,o){for(var a=e,c=a+o;c<=r;c+=o)t.moveTo(c,i),t.lineTo(a,n),a+=o}function yn(t,e,n,r,i,o){for(var a=e,c=a+o;c<=r;c+=o)t.moveTo(a,i),t.lineTo(c,n),a+=o}function dn(t,e,n,r,i,o){for(var a=n;a<i;a+=o)t.moveTo(e,a),t.lineTo(r,a)}var vn=function(){function t(e,n,r){en(this,t),this.el=e,this.ctx=e.getContext("2d"),this.resize(n,r),this.ctx.scale(on(),on())}return rn(t,[{key:"resize",value:function(t,e){this.el.style.width="".concat(t,"px"),this.el.style.height="".concat(e,"px"),this.el.width=cn(t),this.el.height=cn(e)}},{key:"clear",value:function(){var t=this.el,e=t.width,n=t.height;return this.ctx.clearRect(0,0,e,n),this}},{key:"attr",value:function(t){return Object.assign(this.ctx,t),this}},{key:"save",value:function(){return this.ctx.save(),this.ctx.beginPath(),this}},{key:"restore",value:function(){return this.ctx.restore(),this}},{key:"beginPath",value:function(){return this.ctx.beginPath(),this}},{key:"translate",value:function(t,e){return this.ctx.translate(cn(t),cn(e)),this}},{key:"scale",value:function(t,e){return this.ctx.scale(t,e),this}},{key:"clearRect",value:function(t,e,n,r){return this.ctx.clearRect(t,e,n,r),this}},{key:"fillRect",value:function(t,e,n,r){return this.ctx.fillRect(cn(t)-.5,cn(e)-.5,cn(n),cn(r)),this}},{key:"fillText",value:function(t,e,n){return this.ctx.fillText(t,cn(e),cn(n)),this}},{key:"text",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=this.ctx,a=r.align,c=r.valign,l=r.font,u=r.color,s=r.strike,f=r.underline,h=e.textx(a);o.save(),o.beginPath(),this.attr({textAlign:a,textBaseline:c,font:"".concat(l.italic?"italic":""," ").concat(l.bold?"bold":""," ").concat(cn(l.size),"px ").concat(l.name),fillStyle:u,strokeStyle:u});var p="".concat(t).split("\n"),y=e.innerWidth(),d=[];p.forEach((function(t){var e=o.measureText(t).width;if(i&&e>cn(y)){for(var n={w:0,len:0,start:0},r=0;r<t.length;r+=1)n.w>=cn(y)&&(d.push(t.substr(n.start,n.len)),n={w:0,len:0,start:r}),n.len+=1,n.w+=o.measureText(t[r]).width+1;n.len>0&&d.push(t.substr(n.start,n.len))}else d.push(t)}));var v=(d.length-1)*(l.size+2),b=e.texty(c,v);return d.forEach((function(t){var e=o.measureText(t).width;n.fillText(t,h,b),s&&sn.call(n,"strike",h,b,a,c,l.size,e),f&&sn.call(n,"underline",h,b,a,c,l.size,e),b+=l.size+2})),o.restore(),this}},{key:"border",value:function(t,e){var n=this.ctx;return n.lineWidth=an,n.strokeStyle=e,"medium"===t?n.lineWidth=cn(2)-.5:"thick"===t?n.lineWidth=cn(3):"dashed"===t?n.setLineDash([cn(3),cn(2)]):"dotted"===t?n.setLineDash([cn(1),cn(1)]):"double"===t&&n.setLineDash([cn(2),0]),this}},{key:"line",value:function(){var t=this.ctx;if(arguments.length>1){t.beginPath();var e=arguments.length<=0?void 0:arguments[0],n=Ge(e,2),r=n[0],i=n[1];t.moveTo(ln(r),ln(i));for(var o=1;o<arguments.length;o+=1){var a=o<0||arguments.length<=o?void 0:arguments[o],c=Ge(a,2),l=c[0],u=c[1];t.lineTo(ln(l),ln(u))}t.stroke()}return this}},{key:"strokeBorders",value:function(t){var e=this.ctx;e.save();var n=t.borderTop,r=t.borderRight,i=t.borderBottom,o=t.borderLeft;n&&(this.border.apply(this,Je(n)),this.line.apply(this,Je(t.topxys()))),r&&(this.border.apply(this,Je(r)),this.line.apply(this,Je(t.rightxys()))),i&&(this.border.apply(this,Je(i)),this.line.apply(this,Je(t.bottomxys()))),o&&(this.border.apply(this,Je(o)),this.line.apply(this,Je(t.leftxys()))),e.restore()}},{key:"strokePattern",value:function(t){var e=this.ctx;e.save();var n=t.x,r=t.y,i=t.width,o=t.height,a=t.pattern;if(a){e.beginPath();var c=ln(n),l=c+cn(i),u=ln(r),s=u+cn(o);switch(a){case"None":case"Solid":break;case"HorizontalStripe":e.lineWidth=2,e.setLineDash([]),fn(e,c,u,l,s,4);break;case"ThinHorizontalStripe":e.lineWidth=1,e.setLineDash([]),fn(e,c,u,l,s,4);break;case"Gray75":e.lineWidth=2,e.setLineDash([2]),dn(e,c,u,l,s,3);break;case"VerticalStripe":e.lineWidth=2,e.setLineDash([]),hn(e,c,u,l,s,4);break;case"ThinVerticalStripe":e.lineWidth=1,e.setLineDash([]),hn(e,c,u,l,s,4);break;case"Gray50":e.lineWidth=2,e.setLineDash([2]),dn(e,c,u,l,s,3.5);break;case"ReverseDiagonalStripe":e.lineWidth=2,e.setLineDash([]),pn(e,c,u,l,s,4);break;case"ThinReverseDiagonalStripe":e.lineWidth=1,e.setLineDash([]),pn(e,c,u,l,s,4);break;case"Gray25":e.lineWidth=2,e.setLineDash([2]),dn(e,c,u,l,s,4);break;case"DiagonalStripe":e.lineWidth=2,e.setLineDash([]),yn(e,c,u,l,s,4);break;case"ThinDiagonalStripe":e.lineWidth=1,e.setLineDash([]),yn(e,c,u,l,s,4);break;case"Gray12":e.lineWidth=2,e.setLineDash([2]),dn(e,c,u,l,s,4.5);break;case"DiagonalCrosshatch":e.lineWidth=1.5,e.setLineDash([]),pn(e,c,u,l,s,4),yn(e,c,u,l,s,4);break;case"ThinHorizontalCrosshatch":e.lineWidth=1,e.setLineDash([]),fn(e,c,u,l,s,4),hn(e,c,u,l,s,4);break;case"Gray6":e.lineWidth=2,e.setLineDash([2]),dn(e,c,u,l,s,5);break;case"ThickDiagonalCrosshatch":e.lineWidth=2,e.setLineDash([]),pn(e,c,u,l,s,4),yn(e,c,u,l,s,4);break;case"ThinDiagonalCrosshatch":e.lineWidth=1,e.setLineDash([]),pn(e,c,u,l,s,4),yn(e,c,u,l,s,4)}e.closePath(),e.stroke()}e.restore()}},{key:"dropdown",value:function(t){var e=this.ctx,n=t.x,r=t.y,i=n+t.width-15,o=r+t.height-15;e.save(),e.beginPath(),e.moveTo(cn(i),cn(o)),e.lineTo(cn(i+8),cn(o)),e.lineTo(cn(i+4),cn(o+6)),e.closePath(),e.fillStyle="rgba(0, 0, 0, .45)",e.fill(),e.restore()}},{key:"error",value:function(t){var e=this.ctx,n=t.x,r=t.y,i=n+t.width-1;e.save(),e.beginPath(),e.moveTo(cn(i-8),cn(r-1)),e.lineTo(cn(i),cn(r-1)),e.lineTo(cn(i),cn(r+8)),e.closePath(),e.fillStyle="rgba(255, 0, 0, .65)",e.fill(),e.restore()}},{key:"frozen",value:function(t){var e=this.ctx,n=t.x,r=t.y,i=n+t.width-1;e.save(),e.beginPath(),e.moveTo(cn(i-8),cn(r-1)),e.lineTo(cn(i),cn(r-1)),e.lineTo(cn(i),cn(r+8)),e.closePath(),e.fillStyle="rgba(0, 255, 0, .85)",e.fill(),e.restore()}},{key:"rect",value:function(t,e){var n=this.ctx,r=t.x,i=t.y,o=t.width,a=t.height,c=t.bgcolor,l=t.pbgcolor;n.save(),n.beginPath(),n.fillStyle=void 0!==c?c:void 0!==l?l:"#ffffff",n.rect(ln(r+1),ln(i+1),cn(o-2),cn(a-2)),n.clip(),n.fill(),e(),n.restore()}}]),t}(),bn=[{key:"Arial",title:"Arial"},{key:"Helvetica",title:"Helvetica"},{key:"Source Sans Pro",title:"Source Sans Pro"},{key:"Comic Sans MS",title:"Comic Sans MS"},{key:"Courier New",title:"Courier New"},{key:"Verdana",title:"Verdana"},{key:"Lato",title:"Lato"}],mn=[{pt:7.5,px:10},{pt:8,px:11},{pt:9,px:12},{pt:10,px:13},{pt:10.5,px:14},{pt:11,px:15},{pt:12,px:16},{pt:14,px:18.7},{pt:15,px:20},{pt:16,px:21.3},{pt:18,px:24},{pt:22,px:29.3},{pt:24,px:32},{pt:26,px:34.7},{pt:36,px:48},{pt:42,px:56}];function gn(t){for(var e=0;e<mn.length;e+=1){var n=mn[e];if(n.pt===t)return n.px}return t}function wn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,c=t[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return kn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return kn(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Sn=function(t){for(var e=[],n=[],r=[],i=0,o="",a=1,c="",l=0;l<t.length;l+=1){var u=t.charAt(l);if(" "!==u){if(u>="a"&&u<="z")r.push(u.toUpperCase());else if(u>="0"&&u<="9"||u>="A"&&u<="Z"||"."===u)r.push(u);else if('"'===u){for(l+=1;'"'!==t.charAt(l);)r.push(t.charAt(l)),l+=1;n.push('"'.concat(r.join(""))),r=[]}else if("-"===u&&/[+\-*/,(]/.test(c))r.push(u);else{if("("!==u&&r.length>0&&n.push(r.join("")),")"===u){var s=e.pop();if(2===i)try{for(var f=wn(y(n.pop()),2),h=f[0],p=f[1],v=wn(y(n.pop()),2),b=v[0],m=v[1],g=0,w=b;w<=h;w+=1)for(var k=m;k<=p;k+=1)n.push(d(w,k)),g+=1;n.push([s,g])}catch(t){}else if(1===i||3===i)3===i&&n.push(o),n.push([s,a]),a=1;else for(;"("!==s&&(n.push(s),!(e.length<=0));)s=e.pop();i=0}else if("="===u||">"===u||"<"===u){var S=t.charAt(l+1);o=u,"="!==S&&"-"!==S||(o+=S,l+=1),i=3}else if(":"===u)i=2;else if(","===u)3===i&&n.push(o),i=1,a+=1;else if("("===u&&r.length>0)e.push(r.join(""));else{if(e.length>0&&("+"===u||"-"===u)){var O=e[e.length-1];if("("!==O&&n.push(e.pop()),"*"===O||"/"===O)for(;e.length>0&&"("!==(O=e[e.length-1]);)n.push(e.pop())}e.push(u)}r=[]}c=u}}for(r.length>0&&n.push(r.join(""));e.length>0;)n.push(e.pop());return n},On=function(t,e){var n=wn(t,1)[0],r=t;if('"'===n)return t.substring(1);var i=1;if("-"===n&&(r=t.substring(1),i=-1),r[0]>="0"&&r[0]<="9")return i*Number(r);var o=wn(y(r),2);return i*e(o[0],o[1])},xn=function(t,e,n,r){for(var i=[],o=0;o<t.length;o+=1){var a=t[o],c=a[0];if("+"===a){var l=i.pop();i.push(W("+",i.pop(),l))}else if("-"===a)if(1===i.length){var u=i.pop();i.push(W("*",u,-1))}else{var s=i.pop();i.push(W("-",i.pop(),s))}else if("*"===a)i.push(W("*",i.pop(),i.pop()));else if("/"===a){var f=i.pop();i.push(W("/",i.pop(),f))}else if("="===c||">"===c||"<"===c){var h=i.pop();Number.isNaN(h)||(h=Number(h));var p=i.pop();Number.isNaN(p)||(p=Number(p));var y=!1;"="===c?y=p===h:">"===a?y=p>h:">="===a?y=p>=h:"<"===a?y=p<h:"<="===a&&(y=p<=h),i.push(y)}else if(Array.isArray(a)){for(var d=wn(a,2),v=d[0],b=d[1],m=[],g=0;g<b;g+=1)m.push(i.pop());i.push(e[v].render(m.reverse()))}else{if(r.includes(a))return 0;(c>="a"&&c<="z"||c>="A"&&c<="Z")&&r.push(a),i.push(On(a,n)),r.pop()}}return i[0]},jn=function t(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if("="===e[0]){var o=Sn(e.substring(1));return o.length<=0?e:xn(o,n,(function(e,o){return t(r(e,o),n,r,i)}),i)}return e};function En(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,c=t[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return n}(t,e)||Rn(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Cn(t){return function(t){if(Array.isArray(t))return _n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||Rn(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rn(t,e){if(t){if("string"==typeof t)return _n(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_n(t,e):void 0}}function _n(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var An=[{key:"SUM",title:et("formula.sum"),render:function(t){return t.reduce((function(t,e){return W("+",t,e)}),0)}},{key:"AVERAGE",title:et("formula.average"),render:function(t){return t.reduce((function(t,e){return Number(t)+Number(e)}),0)/t.length}},{key:"MAX",title:et("formula.max"),render:function(t){return Math.max.apply(Math,Cn(t.map((function(t){return Number(t)}))))}},{key:"MIN",title:et("formula.min"),render:function(t){return Math.min.apply(Math,Cn(t.map((function(t){return Number(t)}))))}},{key:"IF",title:et("formula._if"),render:function(t){var e=En(t,3),n=e[0],r=e[1],i=e[2];return n?r:i}},{key:"AND",title:et("formula.and"),render:function(t){return t.every((function(t){return t}))}},{key:"OR",title:et("formula.or"),render:function(t){return t.some((function(t){return t}))}},{key:"CONCAT",title:et("formula.concat"),render:function(t){return t.join("")}}],Pn=An,Tn={};function Dn(t){return function(t){if(Array.isArray(t))return Mn(t)}(t)||Nn(t)||zn(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function In(t){return function(t){if(Array.isArray(t))return t}(t)||Nn(t)||zn(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zn(t,e){if(t){if("string"==typeof t)return Mn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Mn(t,e):void 0}}function Mn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Nn(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}An.forEach((function(t){Tn[t.key]=t}));var Hn=function(t){return t},Fn=function(t){if(/^(-?\d*.?\d*)$/.test(t)){var e=In(Number(t).toFixed(2).toString().split("\\.")),n=e[0],r=e.slice(1);return[n.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")].concat(Dn(r))}return t},Wn=[{key:"normal",title:et("format.normal"),type:"string",render:Hn},{key:"text",title:et("format.text"),type:"string",render:Hn},{key:"number",title:et("format.number"),type:"number",label:"1,000.12",render:Fn},{key:"percent",title:et("format.percent"),type:"number",label:"10.12%",render:function(t){return"".concat(t,"%")}},{key:"rmb",title:et("format.rmb"),type:"number",label:"10.00",render:function(t){return"".concat(Fn(t))}},{key:"usd",title:et("format.usd"),type:"number",label:"$10.00",render:function(t){return"$".concat(Fn(t))}},{key:"eur",title:et("format.eur"),type:"number",label:"10.00",render:function(t){return"".concat(Fn(t))}},{key:"date",title:et("format.date"),type:"date",label:"26/09/2008",render:Hn},{key:"time",title:et("format.time"),type:"date",label:"15:59:00",render:Hn},{key:"datetime",title:et("format.datetime"),type:"date",label:"26/09/2008 15:59:00",render:Hn},{key:"duration",title:et("format.duration"),type:"date",label:"24:01:00",render:Hn}],Vn={};function Un(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,c=t[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return qn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qn(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function $n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Wn.forEach((function(t){Vn[t.key]=t}));var Ln={fillStyle:"#f4f5f8"},Bn={fillStyle:"#fff",lineWidth:an,strokeStyle:"#e6e6e6"};function Yn(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=t.cellRect(e,n),o=i.left,a=i.top,c=i.width,l=i.height;return new un(o,a+r,c,l,5)}function Xn(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=e.sortedRowMap,a=e.rows,c=e.cols;if(!a.isHide(n)&&!c.isHide(r)){var l=n;o.has(n)&&(l=o.get(n));var u=e.getCell(l,r);if(null!==u){var s=!1;"editable"in u&&!1===u.editable&&(s=!0);var f=e.getCellStyleOrDefault(l,r),h=Yn(e,n,r,i);h.bgcolor=f.bgcolor,h.pbgcolor=f.pbgcolor,void 0!==f.border&&(h.setBorders(f.border),t.strokeBorders(h));var p=h;f.hasbgcolor&&(void 0!==f.border&&void 0!==f.border.borderRight||(p.width+=2),void 0!==f.border&&void 0!==f.border.borderBottom||(p.height+=2)),t.rect(p,(function(){var i="";i=e.settings.evalPaused?u.text||"":jn(u.text||"",Tn,(function(t,n){return e.getCellTextOrDefault(n,t)})),f.format&&(i=Vn[f.format].render(i));var o=Object.assign({},f.font);o.size=gn(o.size),t.text(i,h,{align:f.align,valign:f.valign,font:o,color:f.color,strike:f.strike,underline:f.underline},f.textwrap),e.validations.getError(n,r)&&t.error(h),s&&t.frozen(h),e.comments.forEach((function(e){n===e.row&&r===e.col&&t.error(h)})),void 0!==f.pattern&&(h.setPattern(f.pattern),t.strokePattern(h))}))}}}function Zn(t){var e=this.data,n=this.draw;if(t){var r=e.autoFilter;if(!r.active())return;var i=r.hrange();t.intersects(i)&&i.each((function(t,r){var i=Yn(e,t,r);n.dropdown(i)}))}}function Kn(t,e,n,r,i){var o=this.draw,a=this.data;o.save(),o.translate(e,n).translate(r,i);var c=a.exceptRowSet;o.save(),o.translate(0,-0),t.each((function(t,e){Xn(o,a,t,e)}),(function(t){return function(t){return!c.has(t)}(t)})),o.restore();var l=new Set;o.save(),o.translate(0,-0),a.eachMergesInView(t,(function(t){var e=t.sri,n=t.sci,r=t.eri;if(c.has(e)){if(!l.has(e)){l.add(e);var i=a.rows.sumHeight(e,r+1);o.translate(0,-i)}}else Xn(o,a,e,n)})),o.restore(),Zn.call(this,t),o.restore()}function Jn(t,e,n,r){var i=this.draw;i.save(),i.attr({fillStyle:"rgba(75, 137, 255, 0.08)"}).fillRect(t,e,n,r),i.restore()}function Gn(t,e,n,r,i,o){var a=this,c=this.draw,l=this.data,u=e.h,s=e.w,f=o+r,p=i+n;c.save(),c.attr(Ln),"all"!==t&&"left"!==t||c.fillRect(0,f,n,u),"all"!==t&&"top"!==t||c.fillRect(p,0,s,r);var y=l.selector.range,d=y.sri,v=y.sci,b=y.eri,m=y.eci;c.attr({textAlign:"center",textBaseline:"middle",font:"500 ".concat(cn(12),"px Source Sans Pro"),fillStyle:"#585757",lineWidth:an(),strokeStyle:"#e6e6e6"}),"all"!==t&&"left"!==t||(l.rowEach(e.sri,e.eri,(function(t,e,r){var i=f+e,o=t;c.line([0,i],[n,i]),d<=o&&o<b+1&&Jn.call(a,0,i,n,r),c.fillText(o+1,n/2,i+r/2),t>0&&l.rows.isHide(t-1)&&(c.save(),c.attr({strokeStyle:"#c6c6c6"}),c.line([5,i+5],[n-5,i+5]),c.restore())})),c.line([0,u+f],[n,u+f]),c.line([n,f],[n,u+f])),"all"!==t&&"top"!==t||(l.colEach(e.sci,e.eci,(function(t,e,n){var i=p+e,o=t;c.line([i,0],[i,r]),v<=o&&o<m+1&&Jn.call(a,i,0,n,r),c.fillText(h(o),i+n/2,r/2),t>0&&l.cols.isHide(t-1)&&(c.save(),c.attr({strokeStyle:"#c6c6c6"}),c.line([i+5,5],[i+5,r-5]),c.restore())})),c.line([s+p,0],[s+p,r]),c.line([0,r],[s+p,r])),c.restore()}function Qn(t,e){var n=this.draw;n.save(),n.attr({fillStyle:"#f4f5f8"}).fillRect(0,0,t,e),n.restore()}function tr(t,e,n,r,i){var o=t.sri,a=t.sci,c=t.eri,l=t.eci,u=t.w,s=t.h,f=this.draw,h=this.data;h.settings;f.save(),f.attr(Bn).translate(e+r,n+i),f.clearRect(0,0,u,s),h.showGrid?(h.rowEach(o,c,(function(t,e,n){t!==o&&f.line([0,e],[u,e]),t===c&&f.line([0,e+n],[u,e+n])})),h.colEach(a,l,(function(t,e,n){t!==a&&f.line([e,0],[e,s]),t===l&&f.line([e+n,0],[e+n,s])})),f.restore()):f.restore()}function er(t,e,n,r){var i=this.draw,o=this.data,a=o.viewWidth()-t,c=o.viewHeight()-e;i.save().translate(t,e).attr({strokeStyle:"rgba(75, 137, 255, .6)"}),i.line([0,r],[a,r]),i.line([n,0],[n,c]),i.restore()}var nr=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=e,this.draw=new vn(e,n.viewWidth(),n.viewHeight()),this.data=n}var e,n,r;return e=t,(n=[{key:"resetData",value:function(t){this.data=t,this.render()}},{key:"render",value:function(){var t=this.data;if(!t.isupdating){var e=t.rows,n=t.cols.indexWidth,r=e.height;this.draw.resize(t.viewWidth(),t.viewHeight()),this.clear();var i=t.viewRange(),o=t.freezeTotalWidth(),a=t.freezeTotalHeight(),c=t.scroll,l=c.x,u=c.y;tr.call(this,i,n,r,o,a),Kn.call(this,i,n,r,-l,-u),Gn.call(this,"all",i,n,r,o,a),Qn.call(this,n,r);var s=Un(t.freeze,2),f=s[0],h=s[1];if(f>0||h>0){if(f>0){var p=i.clone();p.sri=0,p.eri=f-1,p.h=a,tr.call(this,p,n,r,o,0),Kn.call(this,p,n,r,-l,0),Gn.call(this,"top",p,n,r,o,0)}if(h>0){var y=i.clone();y.sci=0,y.eci=h-1,y.w=o,tr.call(this,y,n,r,0,a),Gn.call(this,"left",y,n,r,0,a),Kn.call(this,y,n,r,0,-u)}var d=t.freezeViewRange();tr.call(this,d,n,r,0,0),Gn.call(this,"all",d,n,r,0,0),Kn.call(this,d,n,r,0,0),er.call(this,n,r,o,a)}}}},{key:"clear",value:function(){this.draw.clear()}}])&&$n(e.prototype,n),r&&$n(e,r),t}();function rr(t){return function(t){if(Array.isArray(t))return ir(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return ir(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ir(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ir(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function or(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ar=[["A3",11.69,16.54],["A4",8.27,11.69],["A5",5.83,8.27],["B4",9.84,13.9],["B5",6.93,9.84]],cr=["landscape","portrait"];function lr(t){return parseInt(96*t,10)}function ur(t){"cancel"===t?this.el.hide():this.toPrint()}function sr(t){var e=this.paper,n=t.target.value,r=ar[n];e.w=lr(r[1]),e.h=lr(r[2]),this.preview()}function fr(t){var e=this.paper,n=t.target.value,r=cr[n];e.orientation=r,this.preview()}var hr=function(){function t(e){var n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.paper={w:lr(ar[0][1]),h:lr(ar[0][2]),padding:50,orientation:cr[0],get width(){return"landscape"===this.orientation?this.h:this.w},get height(){return"landscape"===this.orientation?this.w:this.h}},this.data=e,this.el=l("div","".concat(Nt,"-print")).children(l("div","".concat(Nt,"-print-bar")).children(l("div","-title").child("Print settings"),l("div","-right").children(l("div","".concat(Nt,"-buttons")).children(new Ke("cancel").on("click",ur.bind(this,"cancel")),new Ke("next","primary").on("click",ur.bind(this,"next"))))),l("div","".concat(Nt,"-print-content")).children(this.contentEl=l("div","-content"),l("div","-sider").child(l("form","").children(l("fieldset","").children(l("label","").child("".concat(tt("print.size"))),(n=l("select","")).children.apply(n,rr(ar.map((function(t,e){return l("option","").attr("value",e).child("".concat(t[0]," ( ").concat(t[1],"''x").concat(t[2],"'' )"))})))).on("change",sr.bind(this))),l("fieldset","").children(l("label","").child("".concat(tt("print.orientation"))),(r=l("select","")).children.apply(r,rr(cr.map((function(t,e){return l("option","").attr("value",e).child("".concat(tt("print.orientations")[e]))})))).on("change",fr.bind(this))))))).hide()}var e,n,r;return e=t,(n=[{key:"resetData",value:function(t){this.data=t}},{key:"preview",value:function(){var t=this,e=this.data,n=this.paper,r=n.width,i=n.height,o=n.padding,a=r-2*o,c=i-2*o,u=e.contentRange(),s=parseInt(u.h/c,10)+1,f=a/u.w,h=o,p=o;f>1&&(h+=(a-u.w)/2);var y=0,d=0;this.contentEl.html(""),this.canvases=[];for(var v={sri:0,sci:0,eri:0,eci:0},b=function(n){var o=0,a=0,s=l("div","".concat(Nt,"-canvas-card")),b=l("canvas","".concat(Nt,"-canvas"));t.canvases.push(b.el);var m=new vn(b.el,r,i);for(m.save(),m.translate(h,p),f<1&&m.scale(f,f);y<=u.eri;y+=1){var g=e.rows.getHeight(y);if(!((o+=g)<c)){a=-(o-g);break}for(var w=0;w<=u.eci;w+=1)Xn(m,e,y,w,d),v.eci=w}v.eri=y,m.restore(),m.save(),m.translate(h,p),f<1&&m.scale(f,f);var k=d;e.eachMergesInView(v,(function(t){var n=t.sri,r=t.sci;Xn(m,e,n,r,k)})),m.restore(),v.sri=v.eri,v.sci=v.eci,d+=a,t.contentEl.child(l("div","".concat(Nt,"-canvas-card-wraper")).child(s.child(b)))},m=0;m<s;m+=1)b();this.el.show()}},{key:"toPrint",value:function(){this.el.hide();var t=this.paper,e=l("iframe","").hide().el;window.document.body.appendChild(e);var n=e.contentWindow,r=n.document,i=document.createElement("style");i.innerHTML="\n      @page { size: ".concat(t.width,"px ").concat(t.height,"px; };\n      canvas {\n        page-break-before: auto;        \n        page-break-after: always;\n        image-rendering: pixelated;\n      };\n    "),r.head.appendChild(i),this.canvases.forEach((function(t){var e=t.cloneNode(!1);e.getContext("2d").drawImage(t,0,0),r.body.appendChild(e)})),n.print()}}])&&or(e.prototype,n),r&&or(e,r),t}();function pr(t){return function(t){if(Array.isArray(t))return yr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return yr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return yr(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function dr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function vr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var br=[{key:"copy",title:et("contextmenu.copy"),label:"Ctrl+C"},{key:"cut",title:et("contextmenu.cut"),label:"Ctrl+X"},{key:"paste",title:et("contextmenu.paste"),label:"Ctrl+V"},{key:"paste-value",title:et("contextmenu.pasteValue"),label:"Ctrl+Shift+V"},{key:"paste-format",title:et("contextmenu.pasteFormat"),label:"Ctrl+Alt+V"},{key:"divider"},{key:"insert-row",title:et("contextmenu.insertRow")},{key:"insert-column",title:et("contextmenu.insertColumn")},{key:"divider"},{key:"delete-row",title:et("contextmenu.deleteRow")},{key:"delete-column",title:et("contextmenu.deleteColumn")},{key:"delete-cell-text",title:et("contextmenu.deleteCellText")},{key:"hide",title:et("contextmenu.hide")},{key:"divider"},{key:"validation",title:et("contextmenu.validation")},{key:"divider"},{key:"cell-printable",title:et("contextmenu.cellprintable")},{key:"cell-non-printable",title:et("contextmenu.cellnonprintable")},{key:"divider"},{key:"cell-editable",title:et("contextmenu.celleditable")},{key:"cell-non-editable",title:et("contextmenu.cellnoneditable")}];function mr(t){var e=this;return"divider"===t.key?l("div","".concat(Nt,"-item divider")):l("div","".concat(Nt,"-item")).on("click",(function(){e.itemClick(t.key),e.hide()})).children(t.title(),l("div","label").child(t.label||""))}function gr(){var t=this;return br.map((function(e){return mr.call(t,e)}))}var wr=function(){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];dr(this,t),this.menuItems=gr.call(this),this.el=(n=l("div","".concat(Nt,"-contextmenu"))).children.apply(n,pr(this.menuItems)).hide(),this.viewFn=e,this.itemClick=function(){},this.isHide=r,this.setMode("range")}var e,n,r;return e=t,(n=[{key:"setMode",value:function(t){var e=this.menuItems[12];"row-col"===t?e.show():e.hide()}},{key:"hide",value:function(){var t=this.el;t.hide(),Dt(t)}},{key:"setPosition",value:function(t,e){if(!this.isHide){var n=this.el,r=n.show().offset().width,i=this.viewFn(),o=i.height/2,a=t;i.width-t<=r&&(a-=r),n.css("left","".concat(a,"px")),e>o?n.css("bottom","".concat(i.height-e,"px")).css("max-height","".concat(e,"px")).css("top","auto"):n.css("top","".concat(e,"px")).css("max-height","".concat(i.height-e,"px")).css("bottom","auto"),It(n)}}}])&&vr(e.prototype,n),r&&vr(e,r),t}();function kr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Sr=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tip=tt("toolbar.".concat(e.replace(/-[a-z]/g,(function(t){return t[1].toUpperCase()})))),n&&(this.tip+=" (".concat(n,")")),this.tag=e,this.shortcut=n,this.value=r,this.el=this.element(),this.change=function(){}}var e,n,r;return e=t,(n=[{key:"element",value:function(){var t=this.tip;return l("div","".concat(Nt,"-toolbar-btn")).on("mouseenter",(function(e){!function(t,e){if(!e.classList.contains("active")){var n=e.getBoundingClientRect(),r=n.left,i=n.top,o=n.width,a=n.height,c=l("div","".concat(Nt,"-tooltip")).html(t).show();document.body.appendChild(c.el);var u=c.box();c.css("left","".concat(r+o/2-u.width/2,"px")).css("top","".concat(i+a+2,"px")),Pt(e,"mouseleave",(function(){document.body.contains(c.el)&&document.body.removeChild(c.el)})),Pt(e,"click",(function(){document.body.contains(c.el)&&document.body.removeChild(c.el)}))}}(t,e.target)})).attr("data-tooltip",t)}},{key:"setState",value:function(){}}])&&kr(e.prototype,n),r&&kr(e,r),t}();function Or(t){return(Or="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function jr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Er(t,e,n){return(Er="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ar(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Cr(t,e){return(Cr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Rr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ar(t);if(e){var i=Ar(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return _r(this,n)}}function _r(t,e){return!e||"object"!==Or(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ar(t){return(Ar=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Pr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Cr(t,e)}(o,t);var e,n,r,i=Rr(o);function o(){return xr(this,o),i.apply(this,arguments)}return e=o,(n=[{key:"dropdown",value:function(){}},{key:"getValue",value:function(t){return t}},{key:"element",value:function(){var t=this,e=this.tag;return this.dd=this.dropdown(),this.dd.change=function(n){return t.change(e,t.getValue(n))},Er(Ar(o.prototype),"element",this).call(this).child(this.dd)}},{key:"setState",value:function(t){t&&(this.value=t,this.dd.setTitle(t))}}])&&jr(e.prototype,n),r&&jr(e,r),o}(Sr);function Tr(t){return(Tr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Dr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ir(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function zr(t,e){return(zr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Mr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Hr(t);if(e){var i=Hr(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Nr(this,n)}}function Nr(t,e){return!e||"object"!==Tr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Hr(t){return(Hr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Fr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&zr(t,e)}(o,t);var e,n,r,i=Mr(o);function o(t,e,n,r){var a,c;Dr(this,o),(c=i.call(this,"div","".concat(Nt,"-dropdown ").concat(r))).title=t,c.change=function(){},c.headerClick=function(){},"string"==typeof t?c.title=l("div","".concat(Nt,"-dropdown-title")).child(t):n&&c.title.addClass("arrow-left"),c.contentEl=l("div","".concat(Nt,"-dropdown-content")).css("width",e).hide();for(var u=arguments.length,s=new Array(u>4?u-4:0),f=4;f<u;f++)s[f-4]=arguments[f];return(a=c).setContentChildren.apply(a,s),c.headerEl=l("div","".concat(Nt,"-dropdown-header")),c.headerEl.on("click",(function(){"block"!==c.contentEl.css("display")?c.show():c.hide()})).children(c.title,n?l("div","".concat(Nt,"-icon arrow-right")).child(l("div","".concat(Nt,"-icon-img arrow-down"))):""),c.children(c.headerEl,c.contentEl),c}return e=o,(n=[{key:"setContentChildren",value:function(){var t;this.contentEl.html(""),arguments.length>0&&(t=this.contentEl).children.apply(t,arguments)}},{key:"setTitle",value:function(t){this.title.html(t),this.hide()}},{key:"show",value:function(){var t=this;this.contentEl.show(),this.parent().active(),It(this.parent(),(function(){t.hide()}))}},{key:"hide",value:function(){this.parent().active(!1),this.contentEl.hide(),Dt(this.parent())}}])&&Ir(e.prototype,n),r&&Ir(e,r),o}(c);function Wr(t){return(Wr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vr(t){return function(t){if(Array.isArray(t))return Ur(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Ur(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ur(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ur(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function qr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function $r(t,e){return($r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Lr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Yr(t);if(e){var i=Yr(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Br(this,n)}}function Br(t,e){return!e||"object"!==Wr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Yr(t){return(Yr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Xr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$r(t,e)}(o,t);var e,n,r,i=Lr(o);function o(t,e){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var r=new Oe("align-".concat(e)),a=t.map((function(t){return(e="align-".concat(t),l("div","".concat(Nt,"-item")).child(new Oe(e))).on("click",(function(){n.setTitle(t),n.change(t)}));var e}));return n=i.call.apply(i,[this,r,"auto",!0,"bottom-left"].concat(Vr(a)))}return e=o,(n=[{key:"setTitle",value:function(t){this.title.setName("align-".concat(t)),this.hide()}}])&&qr(e.prototype,n),r&&qr(e,r),o}(Fr);function Zr(t){return(Zr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Kr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Jr(t,e){return(Jr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Gr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ti(t);if(e){var i=ti(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Qr(this,n)}}function Qr(t,e){return!e||"object"!==Zr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ti(t){return(ti=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ei=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Jr(t,e)}(o,t);var e,n,r,i=Gr(o);function o(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,"align","",t)}return e=o,(n=[{key:"dropdown",value:function(){var t=this.value;return new Xr(["left","center","right"],t)}}])&&Kr(e.prototype,n),r&&Kr(e,r),o}(Pr);function ni(t){return(ni="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ri(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ii(t,e){return(ii=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function oi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ci(t);if(e){var i=ci(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ai(this,n)}}function ai(t,e){return!e||"object"!==ni(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ci(t){return(ci=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var li=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ii(t,e)}(o,t);var e,n,r,i=oi(o);function o(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,"valign","",t)}return e=o,(n=[{key:"dropdown",value:function(){var t=this.value;return new Xr(["top","middle","bottom"],t)}}])&&ri(e.prototype,n),r&&ri(e,r),o}(Pr);function ui(t){return(ui="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function si(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function hi(t,e,n){return(hi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=vi(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function pi(t,e){return(pi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function yi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=vi(t);if(e){var i=vi(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return di(this,n)}}function di(t,e){return!e||"object"!==ui(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function vi(t){return(vi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var bi=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pi(t,e)}(o,t);var e,n,r,i=yi(o);function o(){return si(this,o),i.apply(this,arguments)}return e=o,(n=[{key:"element",value:function(){var t=this,e=this.tag;return hi(vi(o.prototype),"element",this).call(this).child(new Oe(e)).on("click",(function(){return t.click()}))}},{key:"click",value:function(){this.change(this.tag,this.toggle())}},{key:"setState",value:function(t){this.el.active(t)}},{key:"toggle",value:function(){return this.el.toggle()}},{key:"active",value:function(){return this.el.hasClass("active")}}])&&fi(e.prototype,n),r&&fi(e,r),o}(Sr);function mi(t){return(mi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function wi(t,e){return(wi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ki(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Oi(t);if(e){var i=Oi(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Si(this,n)}}function Si(t,e){return!e||"object"!==mi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Oi(t){return(Oi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var xi=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wi(t,e)}(o,t);var e,n,r,i=ki(o);function o(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,"autofilter")}return e=o,(n=[{key:"setState",value:function(){}}])&&gi(e.prototype,n),r&&gi(e,r),o}(bi);function ji(t){return(ji="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ei(t,e){return(Ei=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ci(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=_i(t);if(e){var i=_i(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ri(this,n)}}function Ri(t,e){return!e||"object"!==ji(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _i(t){return(_i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ai=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ei(t,e)}(n,t);var e=Ci(n);function n(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),e.call(this,"font-bold","Ctrl+B")}return n}(bi);function Pi(t){return(Pi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ti(t,e){return(Ti=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Di(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=zi(t);if(e){var i=zi(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ii(this,n)}}function Ii(t,e){return!e||"object"!==Pi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zi(t){return(zi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Mi=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ti(t,e)}(n,t);var e=Di(n);function n(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),e.call(this,"font-italic","Ctrl+I")}return n}(bi);function Ni(t){return(Ni="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Hi(t,e){return(Hi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Fi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Vi(t);if(e){var i=Vi(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Wi(this,n)}}function Wi(t,e){return!e||"object"!==Ni(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Vi(t){return(Vi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ui=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Hi(t,e)}(n,t);var e=Fi(n);function n(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),e.call(this,"strike","Ctrl+U")}return n}(bi);function qi(t){return(qi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $i(t,e){return($i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Li(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Yi(t);if(e){var i=Yi(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Bi(this,n)}}function Bi(t,e){return!e||"object"!==qi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Yi(t){return(Yi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Xi=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$i(t,e)}(n,t);var e=Li(n);function n(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),e.call(this,"underline","Ctrl+U")}return n}(bi);function Zi(t){return function(t){if(Array.isArray(t))return Ki(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Ki(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ki(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ki(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Ji=["#ffffff","#000100","#e7e5e6","#445569","#5b9cd6","#ed7d31","#a5a5a5","#ffc001","#4371c6","#71ae47"],Gi=[["#f2f2f2","#7f7f7f","#d0cecf","#d5dce4","#deeaf6","#fce5d5","#ededed","#fff2cd","#d9e2f3","#e3efd9"],["#d8d8d8","#595959","#afabac","#adb8ca","#bdd7ee","#f7ccac","#dbdbdb","#ffe59a","#b3c6e7","#c5e0b3"],["#bfbfbf","#3f3f3f","#756f6f","#8596b0","#9cc2e6","#f4b184","#c9c9c9","#fed964","#8eaada","#a7d08c"],["#a5a5a5","#262626","#3a3839","#333f4f","#2e75b5","#c45a10","#7b7b7b","#bf8e01","#2f5596","#538136"],["#7f7f7f","#0c0c0c","#171516","#222a35","#1f4e7a","#843c0a","#525252","#7e6000","#203864","#365624"]],Qi=["#c00000","#fe0000","#fdc101","#ffff01","#93d051","#00b04e","#01b0f1","#0170c1","#012060","#7030a0"];function to(t){var e=this;return l("td","").child(l("div","".concat(Nt,"-color-palette-cell")).on("click.stop",(function(){return e.change(t)})).css("background-color",t))}var eo=function t(){var e,n,r,i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=l("div","".concat(Nt,"-color-palette")),this.change=function(){};var o=l("table","").children((e=l("tbody","")).children.apply(e,[(n=l("tr","".concat(Nt,"-theme-color-placeholders"))).children.apply(n,Zi(Ji.map((function(t){return to.call(i,t)}))))].concat(Zi(Gi.map((function(t){var e;return(e=l("tr","".concat(Nt,"-theme-colors"))).children.apply(e,Zi(t.map((function(t){return to.call(i,t)}))))}))),[(r=l("tr","".concat(Nt,"-standard-colors"))).children.apply(r,Zi(Qi.map((function(t){return to.call(i,t)}))))])));this.el.child(o)};function no(t){return(no="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ro(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function io(t,e){return(io=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function oo(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=co(t);if(e){var i=co(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ao(this,n)}}function ao(t,e){return!e||"object"!==no(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function co(t){return(co=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var lo=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&io(t,e)}(o,t);var e,n,r,i=oo(o);function o(t,e){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var r=new Oe(t).css("height","16px").css("border-bottom","3px solid ".concat(e)),a=new eo;return a.change=function(t){n.setTitle(t),n.change(t)},n=i.call(this,r,"auto",!1,"bottom-left",a.el)}return e=o,(n=[{key:"setTitle",value:function(t){this.title.css("border-color",t),this.hide()}}])&&ro(e.prototype,n),r&&ro(e,r),o}(Fr);function uo(t){return(uo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function so(t){return function(t){if(Array.isArray(t))return fo(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return fo(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fo(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fo(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ho(t,e){return(ho=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function po(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=vo(t);if(e){var i=vo(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return yo(this,n)}}function yo(t,e){return!e||"object"!==uo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function vo(t){return(vo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var bo=[["thin",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" style="user-select: none;"></line></svg>'],["medium",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="2" style="user-select: none;"><line x1="0" y1="1.0" x2="50" y2="1.0" stroke-width="2" stroke="black" style="user-select: none;"></line></svg>'],["thick",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="3" style="user-select: none;"><line x1="0" y1="1.5" x2="50" y2="1.5" stroke-width="3" stroke="black" style="user-select: none;"></line></svg>'],["dashed",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="2" style="user-select: none;"></line></svg>'],["dotted",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="1" style="user-select: none;"></line></svg>']],mo=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ho(t,e)}(n,t);var e=po(n);function n(t){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n);var i=new Oe("line-type"),o=0,a=bo.map((function(e,n){return l("div","".concat(Nt,"-item state ").concat(t===e[0]?"checked":"")).on("click",(function(){a[o].toggle("checked"),a[n].toggle("checked"),o=n,r.hide(),r.change(e)})).child(l("div","".concat(Nt,"-line-type")).html(e[1]))}));return r=e.call.apply(e,[this,i,"auto",!1,"bottom-left"].concat(so(a)))}return n}(Fr);function go(t){return function(t){if(Array.isArray(t))return So(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||ko(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wo(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,c=t[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return n}(t,e)||ko(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ko(t,e){if(t){if("string"==typeof t)return So(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?So(t,e):void 0}}function So(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Oo(){var t;return l("table","").child((t=l("tbody","")).children.apply(t,arguments))}function xo(t){var e=this;return l("td","").child(l("div","".concat(Nt,"-border-palette-cell")).child(new Oe("border-".concat(t))).on("click",(function(){e.mode=t;var n=e.mode,r=e.style,i=e.color;e.change({mode:n,style:r,color:i})})))}var jo=function t(){var e,n,r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.color="#000",this.style="thin",this.mode="all",this.change=function(){},this.ddColor=new lo("line-color",this.color),this.ddColor.change=function(t){r.color=t},this.ddType=new mo(this.style),this.ddType.change=function(t){var e=wo(t,1)[0];r.style=e},this.el=l("div","".concat(Nt,"-border-palette"));var i=Oo(l("tr","").children(l("td","".concat(Nt,"-border-palette-left")).child(Oo((e=l("tr","")).children.apply(e,go(["all","inside","horizontal","vertical","outside"].map((function(t){return xo.call(r,t)})))),(n=l("tr","")).children.apply(n,go(["left","top","right","bottom","none"].map((function(t){return xo.call(r,t)})))))),l("td","".concat(Nt,"-border-palette-right")).children(l("div","".concat(Nt,"-toolbar-btn")).child(this.ddColor.el),l("div","".concat(Nt,"-toolbar-btn")).child(this.ddType.el))));this.el.child(i)};function Eo(t){return(Eo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Co(t,e){return(Co=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ro(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ao(t);if(e){var i=Ao(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return _o(this,n)}}function _o(t,e){return!e||"object"!==Eo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ao(t){return(Ao=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Po=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Co(t,e)}(n,t);var e=Ro(n);function n(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n);var r=new Oe("border-all"),i=new jo;return i.change=function(e){t.change(e),t.hide()},t=e.call(this,r,"auto",!1,"bottom-left",i.el)}return n}(Fr);function To(t){return(To="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Do(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Io(t,e){return(Io=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function zo(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=No(t);if(e){var i=No(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Mo(this,n)}}function Mo(t,e){return!e||"object"!==To(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function No(t){return(No=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ho=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Io(t,e)}(o,t);var e,n,r,i=zo(o);function o(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,"border")}return e=o,(n=[{key:"dropdown",value:function(){return new Po}}])&&Do(e.prototype,n),r&&Do(e,r),o}(Pr);function Fo(t){return(Fo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wo(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Vo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Uo(t,e,n){return(Uo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Bo(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function qo(t,e){return(qo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function $o(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Bo(t);if(e){var i=Bo(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Lo(this,n)}}function Lo(t,e){return!e||"object"!==Fo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Bo(t){return(Bo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Yo=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qo(t,e)}(o,t);var e,n,r,i=$o(o);function o(){return Wo(this,o),i.apply(this,arguments)}return e=o,(n=[{key:"element",value:function(){var t=this;return Uo(Bo(o.prototype),"element",this).call(this).child(new Oe(this.tag)).on("click",(function(){return t.change(t.tag)}))}},{key:"setState",value:function(t){this.el.disabled(t)}}])&&Vo(e.prototype,n),r&&Vo(e,r),o}(Sr);function Xo(t){return(Xo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zo(t,e){return(Zo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ko(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Go(t);if(e){var i=Go(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Jo(this,n)}}function Jo(t,e){return!e||"object"!==Xo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Go(t){return(Go=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Qo=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zo(t,e)}(n,t);var e=Ko(n);function n(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),e.call(this,"clearformat")}return n}(Yo);function ta(t){return(ta="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ea(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function na(t,e){return(na=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ra(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=oa(t);if(e){var i=oa(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ia(this,n)}}function ia(t,e){return!e||"object"!==ta(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function oa(t){return(oa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var aa=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&na(t,e)}(o,t);var e,n,r,i=ra(o);function o(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,"paintformat")}return e=o,(n=[{key:"setState",value:function(){}}])&&ea(e.prototype,n),r&&ea(e,r),o}(bi);function ca(t){return(ca="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function la(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ua(t,e){return(ua=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function sa(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ha(t);if(e){var i=ha(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return fa(this,n)}}function fa(t,e){return!e||"object"!==ca(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ha(t){return(ha=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var pa=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ua(t,e)}(o,t);var e,n,r,i=sa(o);function o(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,"color",void 0,t)}return e=o,(n=[{key:"dropdown",value:function(){var t=this.tag,e=this.value;return new lo(t,e)}}])&&la(e.prototype,n),r&&la(e,r),o}(Pr);function ya(t){return(ya="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function da(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function va(t,e){return(va=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ba(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ga(t);if(e){var i=ga(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ma(this,n)}}function ma(t,e){return!e||"object"!==ya(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ga(t){return(ga=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var wa=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&va(t,e)}(o,t);var e,n,r,i=ba(o);function o(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,"bgcolor",void 0,t)}return e=o,(n=[{key:"dropdown",value:function(){var t=this.tag,e=this.value;return new lo(t,e)}}])&&da(e.prototype,n),r&&da(e,r),o}(Pr);function ka(t){return(ka="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Sa(t){return function(t){if(Array.isArray(t))return Oa(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Oa(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Oa(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Oa(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function xa(t,e){return(xa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ja(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ca(t);if(e){var i=Ca(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ea(this,n)}}function Ea(t,e){return!e||"object"!==ka(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ca(t){return(Ca=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ra=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xa(t,e)}(n,t);var e=ja(n);function n(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n);var r=mn.map((function(e){return l("div","".concat(Nt,"-item")).on("click",(function(){t.setTitle("".concat(e.pt)),t.change(e)})).child("".concat(e.pt))}));return t=e.call.apply(e,[this,"10","60px",!0,"bottom-left"].concat(Sa(r)))}return n}(Fr);function _a(t){return(_a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Aa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Pa(t,e){return(Pa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ta(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ia(t);if(e){var i=Ia(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Da(this,n)}}function Da(t,e){return!e||"object"!==_a(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ia(t){return(Ia=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var za=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pa(t,e)}(o,t);var e,n,r,i=Ta(o);function o(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,"font-size")}return e=o,(n=[{key:"getValue",value:function(t){return t.pt}},{key:"dropdown",value:function(){return new Ra}}])&&Aa(e.prototype,n),r&&Aa(e,r),o}(Pr);function Ma(t){return(Ma="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Na(t){return function(t){if(Array.isArray(t))return Ha(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Ha(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ha(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ha(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Fa(t,e){return(Fa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Wa(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ua(t);if(e){var i=Ua(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Va(this,n)}}function Va(t,e){return!e||"object"!==Ma(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ua(t){return(Ua=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var qa=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fa(t,e)}(n,t);var e=Wa(n);function n(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n);var r=bn.map((function(e){return l("div","".concat(Nt,"-item")).on("click",(function(){t.setTitle(e.title),t.change(e)})).child(e.title)}));return t=e.call.apply(e,[this,bn[0].title,"160px",!0,"bottom-left"].concat(Na(r)))}return n}(Fr);function $a(t){return($a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function La(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ba(t,e){return(Ba=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ya(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Za(t);if(e){var i=Za(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Xa(this,n)}}function Xa(t,e){return!e||"object"!==$a(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Za(t){return(Za=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ka=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ba(t,e)}(o,t);var e,n,r,i=Ya(o);function o(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,"font-name")}return e=o,(n=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new qa}}])&&La(e.prototype,n),r&&La(e,r),o}(Pr);function Ja(t){return(Ja="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ga(t){return function(t){if(Array.isArray(t))return Qa(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Qa(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Qa(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Qa(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function tc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ec(t,e){return(ec=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function nc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ic(t);if(e){var i=ic(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return rc(this,n)}}function rc(t,e){return!e||"object"!==Ja(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ic(t){return(ic=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var oc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ec(t,e)}(o,t);var e,n,r,i=nc(o);function o(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var e=Wn.slice(0);return e.splice(2,0,{key:"divider"}),e.splice(8,0,{key:"divider"}),e=e.map((function(e){var n=l("div","".concat(Nt,"-item"));return"divider"===e.key?n.addClass("divider"):(n.child(e.title()).on("click",(function(){t.setTitle(e.title()),t.change(e)})),e.label&&n.child(l("div","label").html(e.label))),n})),t=i.call.apply(i,[this,"Normal","220px",!0,"bottom-left"].concat(Ga(e)))}return e=o,(n=[{key:"setTitle",value:function(t){for(var e=0;e<Wn.length;e+=1)Wn[e].key===t&&this.title.html(Wn[e].title());this.hide()}}])&&tc(e.prototype,n),r&&tc(e,r),o}(Fr);function ac(t){return(ac="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function cc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function lc(t,e){return(lc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function uc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=fc(t);if(e){var i=fc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return sc(this,n)}}function sc(t,e){return!e||"object"!==ac(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function fc(t){return(fc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var hc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&lc(t,e)}(o,t);var e,n,r,i=uc(o);function o(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,"format")}return e=o,(n=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new oc}}])&&cc(e.prototype,n),r&&cc(e,r),o}(Pr);function pc(t){return(pc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yc(t){return function(t){if(Array.isArray(t))return dc(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return dc(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return dc(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dc(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function vc(t,e){return(vc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function bc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=gc(t);if(e){var i=gc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return mc(this,n)}}function mc(t,e){return!e||"object"!==pc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function gc(t){return(gc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var wc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vc(t,e)}(n,t);var e=bc(n);function n(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n);var r=An.map((function(e){return l("div","".concat(Nt,"-item")).on("click",(function(){t.hide(),t.change(e)})).child(e.key)}));return t=e.call.apply(e,[this,new Oe("formula"),"180px",!0,"bottom-left"].concat(yc(r)))}return n}(Fr);function kc(t){return(kc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Sc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Oc(t,e){return(Oc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function xc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ec(t);if(e){var i=Ec(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return jc(this,n)}}function jc(t,e){return!e||"object"!==kc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ec(t){return(Ec=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Cc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Oc(t,e)}(o,t);var e,n,r,i=xc(o);function o(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,"formula")}return e=o,(n=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new wc}}])&&Sc(e.prototype,n),r&&Sc(e,r),o}(Pr);function Rc(t){return(Rc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _c(t,e){return(_c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ac(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Tc(t);if(e){var i=Tc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Pc(this,n)}}function Pc(t,e){return!e||"object"!==Rc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Tc(t){return(Tc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Dc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_c(t,e)}(n,t);var e=Ac(n);function n(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),e.call(this,"freeze")}return n}(bi);function Ic(t){return(Ic="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Mc(t,e){return(Mc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Nc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Fc(t);if(e){var i=Fc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Hc(this,n)}}function Hc(t,e){return!e||"object"!==Ic(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Fc(t){return(Fc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Wc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Mc(t,e)}(o,t);var e,n,r,i=Nc(o);function o(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,"merge")}return e=o,(n=[{key:"setState",value:function(t,e){this.el.active(t).disabled(e)}}])&&zc(e.prototype,n),r&&zc(e,r),o}(bi);function Vc(t){return(Vc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Uc(t,e){return(Uc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function qc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Lc(t);if(e){var i=Lc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return $c(this,n)}}function $c(t,e){return!e||"object"!==Vc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Lc(t){return(Lc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Bc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Uc(t,e)}(n,t);var e=qc(n);function n(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),e.call(this,"redo","Ctrl+Y")}return n}(Yo);function Yc(t){return(Yc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xc(t,e){return(Xc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Zc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Jc(t);if(e){var i=Jc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Kc(this,n)}}function Kc(t,e){return!e||"object"!==Yc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Jc(t){return(Jc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Gc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xc(t,e)}(n,t);var e=Zc(n);function n(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),e.call(this,"undo","Ctrl+Z")}return n}(Yo);function Qc(t){return(Qc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tl(t,e){return(tl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function el(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=rl(t);if(e){var i=rl(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return nl(this,n)}}function nl(t,e){return!e||"object"!==Qc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function rl(t){return(rl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var il=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&tl(t,e)}(n,t);var e=el(n);function n(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),e.call(this,"print","Ctrl+P")}return n}(Yo);function ol(t){return(ol="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function al(t,e){return(al=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function cl(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ul(t);if(e){var i=ul(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ll(this,n)}}function ll(t,e){return!e||"object"!==ol(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ul(t){return(ul=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var sl=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&al(t,e)}(n,t);var e=cl(n);function n(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),e.call(this,"textwrap")}return n}(bi);function fl(t){return(fl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function pl(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yl(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&dl(t,e)}function dl(t,e){return(dl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function vl(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ml(t);if(e){var i=ml(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return bl(this,n)}}function bl(t,e){return!e||"object"!==fl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ml(t){return(ml=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var gl=function(t){yl(n,t);var e=vl(n);function n(){var t;pl(this,n);var r=new Oe("ellipsis"),i=l("div","".concat(Nt,"-toolbar-more"));return(t=e.call(this,r,"auto",!1,"bottom-right",i)).moreBtns=i,t.contentEl.css("max-width","420px"),t}return n}(Fr),wl=function(t){yl(o,t);var e,n,r,i=vl(o);function o(){var t;return pl(this,o),(t=i.call(this,"more")).el.hide(),t}return e=o,(n=[{key:"dropdown",value:function(){return new gl}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide()}}])&&hl(e.prototype,n),r&&hl(e,r),o}(Pr);function kl(t){return(kl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Sl(t,e){return(Sl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ol(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=jl(t);if(e){var i=jl(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return xl(this,n)}}function xl(t,e){return!e||"object"!==kl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function jl(t){return(jl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var El=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Sl(t,e)}(n,t);var e=Ol(n);function n(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),e.call(this,"sort")}return n}(Yo);function Cl(t){return(Cl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Rl(t,e){return(Rl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Pl(t);if(e){var i=Pl(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Al(this,n)}}function Al(t,e){return!e||"object"!==Cl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Pl(t){return(Pl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Tl=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Rl(t,e)}(n,t);var e=_l(n);function n(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),e.call(this,"search")}return n}(Yo);function Dl(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Il(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function zl(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,c=t[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Ml(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ml(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ml(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Nl(){return l("div","".concat(Nt,"-toolbar-divider"))}function Hl(){var t=this;this.btns2=[],this.items.forEach((function(e){if(Array.isArray(e))e.forEach((function(e){var n=e.el,r=n.box(),i=n.computedStyle(),o=i.marginLeft,a=i.marginRight;t.btns2.push([n,r.width+parseInt(o,10)+parseInt(a,10)])}));else{var n=e.box(),r=e.computedStyle(),i=r.marginLeft,o=r.marginRight;t.btns2.push([e,n.width+parseInt(i,10)+parseInt(o,10)])}}))}function Fl(){var t,e,n=this.el,r=this.btns,i=this.moreEl,o=this.btns2,a=i.dd,c=a.moreBtns,l=a.contentEl,u=n.box(),s=160,f=12,h=[],p=[];o.forEach((function(t,e){var n=zl(t,2),r=n[0],i=n[1];s+=i,e===o.length-1||s<u.width?h.push(r):(f+=i,p.push(r))})),(t=r.html("")).children.apply(t,h),(e=c.html("")).children.apply(e,p),l.css("width","".concat(f,"px")),p.length>0?i.show():i.hide()}var Wl=function(){function t(e,n){var r=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Dl(this,t),this.data=e,this.change=function(){},this.widthFn=n,this.isHide=i;var o=e.defaultStyle();this.items=[[this.undoEl=new Gc,this.redoEl=new Bc,new il,this.paintformatEl=new aa,this.clearformatEl=new Qo],Nl(),[this.formatEl=new hc],Nl(),[this.fontEl=new Ka,this.fontSizeEl=new za],Nl(),[this.boldEl=new Ai,this.italicEl=new Mi,this.underlineEl=new Xi,this.strikeEl=new Ui,this.textColorEl=new pa(o.color)],Nl(),[this.fillColorEl=new wa(o.bgcolor),this.borderEl=new Ho,this.mergeEl=new Wc],Nl(),[this.alignEl=new ei(o.align),this.valignEl=new li(o.valign),this.textwrapEl=new sl],Nl(),[this.freezeEl=new Dc,this.autofilterEl=new xi,this.formulaEl=new Cc,this.moreEl=new wl,this.sortEl=new El,this.searchEl=new Tl]],i&&(this.items=[[this.moreEl=new wl,this.sortEl=new El,this.searchEl=new Tl]]),this.el=l("div","".concat(Nt,"-toolbar")),this.btns=l("div","".concat(Nt,"-toolbar-btns")),this.items.forEach((function(t){Array.isArray(t)?t.forEach((function(t){r.btns.child(t.el),t.change=function(){r.change.apply(r,arguments)}})):r.btns.child(t.el)})),this.el.child(this.btns),this.reset(),setTimeout((function(){Hl.call(r),Fl.call(r)}),0),Pt(window,"resize",(function(){Fl.call(r)}))}var e,n,r;return e=t,(n=[{key:"paintformatActive",value:function(){return this.paintformatEl.active()}},{key:"paintformatToggle",value:function(){this.paintformatEl.toggle()}},{key:"trigger",value:function(t){this["".concat(t,"El")].click()}},{key:"resetData",value:function(t){this.data=t,this.reset()}},{key:"reset",value:function(){if(!this.isHide){var t=this.data,e=t.getSelectedCellStyle();this.undoEl.setState(!t.canUndo()),this.redoEl.setState(!t.canRedo()),this.mergeEl.setState(t.canUnmerge(),!t.selector.multiple()),this.autofilterEl.setState(!t.canAutofilter());var n=e.font,r=e.format;this.formatEl.setState(r),this.fontEl.setState(n.name),this.fontSizeEl.setState(n.size),this.boldEl.setState(n.bold),this.italicEl.setState(n.italic),this.underlineEl.setState(e.underline),this.strikeEl.setState(e.strike),this.textColorEl.setState(e.color),this.fillColorEl.setState(e.bgcolor),this.alignEl.setState(e.align),this.valignEl.setState(e.valign),this.textwrapEl.setState(e.textwrap),this.freezeEl.setState(t.freezeIsActive())}}}])&&Il(e.prototype,n),r&&Il(e,r),t}();function Vl(t){return function(t){if(Array.isArray(t))return Ul(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Ul(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ul(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ul(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ql(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ll=function(){function t(e,n){var r,i=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"600px",a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],c=arguments.length>4&&void 0!==arguments[4]&&arguments[4];ql(this,t),this.moving=!1,this.drag=c,this.title=e,this.el=l("div","".concat(Nt,"-modal")).css("width",o).css("position","absolute").children(l("div","".concat(Nt,"-modal-header")).children(new Oe("close").on("click.stop",(function(){return i.hide()})),this.title),(r=l("div","".concat(Nt,"-modal-content"))).children.apply(r,Vl(n))).hide(),this.showDimmer=a,this.drag&&this.el.on("mousedown.stop",(function(t){return i.mousedownHandler(t)}))}var e,n,r;return e=t,(n=[{key:"show",value:function(){var t=this;if(!this.moving){this.showDimmer&&(this.dimmer=l("div","".concat(Nt,"-dimmer active")),document.body.appendChild(this.dimmer.el));var e=this.el.show().box(),n=e.width,r=e.height,i=document.documentElement,o=i.clientHeight,a=i.clientWidth;this.el.offset({left:(a-n)/2,top:(o-r)/3}),window.xkeydownEsc=function(e){27===e.keyCode&&t.hide()},Pt(window,"keydown",window.xkeydownEsc)}}},{key:"hide",value:function(){this.el.hide(),this.showDimmer&&document.body.removeChild(this.dimmer.el),Tt(window,"keydown",window.xkeydownEsc),delete window.xkeydownEsc}},{key:"mousedownHandler",value:function(t){var e=this,n=t;zt(window,(function(t){if(e.moving=!0,null!==n){var r=e.el.offset(void 0);e.el.offset({left:r.left+t.movementX,top:r.top+t.movementY}),n=t}}),(function(){n=null,e.moving=!1}))}}])&&$l(e.prototype,n),r&&$l(e,r),t}();function Bl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Yl=function(){function t(e,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.vchange=function(){},this.el=l("div","".concat(Nt,"-form-input")),this.input=l("input","").css("width",e).on("input",(function(t){return r.vchange(t)})).attr("placeholder",n),this.el.child(this.input)}var e,n,r;return e=t,(n=[{key:"focus",value:function(){var t=this;setTimeout((function(){t.input.el.focus()}),10)}},{key:"hint",value:function(t){this.input.attr("placeholder",t)}},{key:"val",value:function(t){return this.input.val(t)}}])&&Bl(e.prototype,n),r&&Bl(e,r),t}();function Xl(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Zl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Kl=function(){function t(e,n,r){var i=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(t){return t},a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){};Xl(this,t),this.key=e,this.getTitle=o,this.vchange=function(){},this.el=l("div","".concat(Nt,"-form-select")),this.suggest=new ve(n.map((function(t){return{key:t,title:i.getTitle(t)}})),(function(t){i.itemClick(t.key),a(t.key),i.vchange(t.key)}),r,this.el),this.el.children(this.itemEl=l("div","input-text").html(this.getTitle(e)),this.suggest.el).on("click",(function(){return i.show()}))}var e,n,r;return e=t,(n=[{key:"show",value:function(){this.suggest.search("")}},{key:"itemClick",value:function(t){this.key=t,this.itemEl.html(this.getTitle(t))}},{key:"val",value:function(t){return void 0!==t?(this.key=t,this.itemEl.html(this.getTitle(t)),this):this.key}}])&&Zl(e.prototype,n),r&&Zl(e,r),t}();function Jl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Gl={number:/(^\d+$)|(^\d+(\.\d{0,4})?$)/,date:/^\d{4}-\d{1,2}-\d{1,2}$/},Ql=function(){function t(e,n,r,i){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.label="",this.rule=n,r&&(this.label=l("label","label").css("width","".concat(i,"px")).html(r)),this.tip=l("div","tip").child("tip").hide(),this.input=e,this.input.vchange=function(){return o.validate()},this.el=l("div","".concat(Nt,"-form-field")).children(this.label,e.el,this.tip)}var e,n,r;return e=t,(n=[{key:"isShow",value:function(){return"none"!==this.el.css("display")}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"val",value:function(t){return this.input.val(t)}},{key:"hint",value:function(t){this.input.hint(t)}},{key:"validate",value:function(){var t=this.input,e=this.rule,n=this.tip,r=this.el,i=t.val();return e.required&&/^\s*$/.test(i)?(n.html(tt("validation.required")),r.addClass("error"),!1):!e.type&&!e.pattern||(e.pattern||Gl[e.type]).test(i)?(r.removeClass("error"),!0):(n.html(tt("validation.notMatch")),r.addClass("error"),!1)}}])&&Jl(e.prototype,n),r&&Jl(e,r),t}();function tu(t){return(tu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function eu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function nu(t,e){return(nu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ru(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ou(t);if(e){var i=ou(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return iu(this,n)}}function iu(t,e){return!e||"object"!==tu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ou(t){return(ou=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var au=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&nu(t,e)}(o,t);var e,n,r,i=ru(o);function o(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var e=new Ql(new Kl("cell",["cell"],"100%",(function(t){return tt("dataValidation.modeType.".concat(t))})),{required:!0},"".concat(tt("dataValidation.range"),":"),100),n=new Ql(new Yl("120px","E3 or E3:F12"),{required:!0,pattern:/^([A-Z]{1,2}[1-9]\d*)(:[A-Z]{1,2}[1-9]\d*)?$/}),r=new Ql(new Kl("list",["list","number","date","phone","email"],"100%",(function(t){return tt("dataValidation.type.".concat(t))}),(function(e){return t.criteriaSelected(e)})),{required:!0},"".concat(tt("dataValidation.criteria"),":"),100),a=new Ql(new Kl("be",["be","nbe","eq","neq","lt","lte","gt","gte"],"160px",(function(t){return tt("dataValidation.operator.".concat(t))}),(function(e){return t.criteriaOperatorSelected(e)})),{required:!0}).hide(),c=new Ql(new Yl("70px","10"),{required:!0}).hide(),u=new Ql(new Yl("70px","100"),{required:!0,type:"number"}).hide(),s=new Ql(new Yl("120px","a,b,c"),{required:!0}),f=new Ql(new Yl("70px","10"),{required:!0,type:"number"}).hide();return(t=i.call(this,tt("contextmenu.validation"),[l("div","".concat(Nt,"-form-fields")).children(e.el,n.el),l("div","".concat(Nt,"-form-fields")).children(r.el,a.el,c.el,u.el,f.el,s.el),l("div","".concat(Nt,"-buttons")).children(new Ke("cancel").on("click",(function(){return t.btnClick("cancel")})),new Ke("remove").on("click",(function(){return t.btnClick("remove")})),new Ke("save","primary").on("click",(function(){return t.btnClick("save")})))])).mf=e,t.rf=n,t.cf=r,t.of=a,t.minvf=c,t.maxvf=u,t.vf=f,t.svf=s,t.change=function(){},t}return e=o,(n=[{key:"showVf",value:function(t){var e="date"===t?"2018-11-12":"10",n=this.vf;n.input.hint(e),n.show()}},{key:"criteriaSelected",value:function(t){var e=this.of,n=this.minvf,r=this.maxvf,i=this.vf,o=this.svf;"date"===t||"number"===t?(e.show(),n.rule.type=t,r.rule.type=t,"date"===t?(n.hint("2018-11-12"),r.hint("2019-11-12")):(n.hint("10"),r.hint("100")),n.show(),r.show(),i.hide(),o.hide()):("list"===t?o.show():o.hide(),i.hide(),e.hide(),n.hide(),r.hide())}},{key:"criteriaOperatorSelected",value:function(t){if(t){var e=this.minvf,n=this.maxvf,r=this.vf;if("be"===t||"nbe"===t)e.show(),n.show(),r.hide();else{var i=this.cf.val();r.rule.type=i,"date"===i?r.hint("2018-11-12"):r.hint("10"),r.show(),e.hide(),n.hide()}}}},{key:"btnClick",value:function(t){if("cancel"===t)this.hide();else if("remove"===t)this.change("remove"),this.hide();else if("save"===t){for(var e=["mf","rf","cf","of","svf","vf","minvf","maxvf"],n=0;n<e.length;n+=1){var r=this[e[n]];if(r.isShow()&&!r.validate())return}var i=this.mf.val(),o=this.rf.val(),a=this.cf.val(),c="phone"===a||"email"===a?"":this.of.val(),l=this.svf.val();"number"!==a&&"date"!==a||(l="be"===c||"nbe"===c?[this.minvf.val(),this.maxvf.val()]:this.vf.val()),this.change("save",i,o,{type:a,operator:c,required:!1,value:l}),this.hide()}}},{key:"setValue",value:function(t){if(t){var e=this.mf,n=this.rf,r=this.cf,i=this.of,o=this.svf,a=this.vf,c=this.minvf,l=this.maxvf,u=t.mode,s=t.ref,f=t.validator||{type:"list"},h=f.type,p=f.operator,y=f.value;e.val(u||"cell"),n.val(s),r.val(h),i.val(p),Array.isArray(y)?(c.val(y[0]),l.val(y[1])):(o.val(y||""),a.val(y||"")),this.criteriaSelected(h),this.criteriaOperatorSelected(p)}this.show()}}])&&eu(e.prototype,n),r&&eu(e,r),o}(Ll);function cu(t){return(cu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function uu(t,e){return(uu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function su(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=hu(t);if(e){var i=hu(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return fu(this,n)}}function fu(t,e){return!e||"object"!==cu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function hu(t){return(hu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var pu=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&uu(t,e)}(o,t);var e,n,r,i=su(o);function o(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var e=new Ql(new Yl("120px",""),{required:!0,pattern:/^([A-Z]{1,2}[1-9]\d*)(:[A-Z]{1,2}[1-9]\d*)?$/},"".concat(tt("dataSort.ci"),":"),100),n=new Ql(new Kl("desc",["asc","desc"],"100%",(function(t){return tt("dataSort.order.".concat(t))}),(function(){})),{required:!0},"".concat(tt("dataSort.criteria"),":"),100);return(t=i.call(this,tt("contextmenu.sort"),[l("div","".concat(Nt,"-form-fields")).children(e.el),l("div","".concat(Nt,"-form-fields")).children(n.el),l("div","".concat(Nt,"-buttons")).children(new Ke("cancel").on("click",(function(){return t.btnClick("cancel")})),new Ke("ok","primary").on("click",(function(){return t.btnClick("ok")})))])).cf=e,t.of=n,t.ci=null,t.values=[],t.change=function(){},t}return e=o,(n=[{key:"btnClick",value:function(t){if("ok"===t){if(!this.cf.validate())return;var e=this.ci,n=this.values,r=this.of.val();this.change("ok",e,r,n)}this.hide()}},{key:"setValue",value:function(t){if(t){var e=this.cf,n=this.of,r=t.ref,i=t.sort,o=t.ci,a=t.m,c=(i||{order:"asc"}).order;e.val(r),n.val(c),this.ci=o,this.values=a}this.show()}}])&&lu(e.prototype,n),r&&lu(e,r),o}(Ll);function yu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function du(t){return l("div","".concat(Nt,"-item ").concat(t))}function vu(t){var e=this;return du("state").child(tt("sort.".concat(t))).on("click.stop",(function(){return e.itemClick(t)}))}function bu(t){var e=this,n=this.filterbEl,r=this.filterValues;n.html(""),Object.keys(t).forEach((function(i,o){var a=t[i],c=r.includes(i)?"checked":"";n.child(l("div","".concat(Nt,"-item state ").concat(c)).on("click.stop",(function(){return e.filterClick(o,i)})).children(""===i?tt("filter.empty"):i,l("div","label").html("(".concat(a,")"))))}))}function mu(){var t=this.filterhEl,e=this.filterValues,n=this.values;t.html("".concat(e.length," / ").concat(n.length)),t.checked(e.length===n.length)}var gu=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.filterbEl=l("div","".concat(Nt,"-body")),this.filterhEl=l("div","".concat(Nt,"-header state")).on("click.stop",(function(){return e.filterClick(0,"all")})),this.el=l("div","".concat(Nt,"-sort-filter")).children(this.sortAscEl=vu.call(this,"asc"),this.sortDescEl=vu.call(this,"desc"),du("divider"),l("div","".concat(Nt,"-filter")).children(this.filterhEl,this.filterbEl),l("div","".concat(Nt,"-buttons")).children(new Ke("cancel").on("click",(function(){return e.btnClick("cancel")})),new Ke("ok","primary").on("click",(function(){return e.btnClick("ok")})))).hide(),this.ci=null,this.sortDesc=null,this.values=null,this.filterValues=[]}var e,n,r;return e=t,(n=[{key:"btnClick",value:function(t){if("ok"===t){var e=this.ci,n=this.sort,r=this.filterValues;this.ok&&this.ok(e,n,"in",r)}this.hide()}},{key:"itemClick",value:function(t){this.sort=t;var e=this.sortAscEl,n=this.sortDescEl;e.checked("asc"===t),n.checked("desc"===t)}},{key:"filterClick",value:function(t,e){var n=this.filterbEl,r=this.filterValues,i=this.values,o=n.children();"all"===e?o.length===r.length?(this.filterValues=[],o.forEach((function(t){return l(t).checked(!1)}))):(this.filterValues=Array.from(i),o.forEach((function(t){return l(t).checked(!0)}))):l(o[t]).toggle("checked")?r.push(e):r.splice(r.findIndex((function(t){return t===e})),1),mu.call(this)}},{key:"set",value:function(t,e,n,r){this.ci=t;var i=this.sortAscEl,o=this.sortDescEl;null!==r?(this.sort=r.order,i.checked(r.asc()),o.checked(r.desc())):(this.sortDesc=null,i.checked(!1),o.checked(!1)),this.values=Object.keys(e),this.filterValues=n?Array.from(n.value):Object.keys(e),bu.call(this,e,n),mu.call(this)}},{key:"setOffset",value:function(t){var e=this;this.el.offset(t).show();var n=1;It(this.el,(function(){n<=0&&(e.hide(),n=5),n-=1}))}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide(),Dt(this.el)}}])&&yu(e.prototype,n),r&&yu(e,r),t}();function wu(t,e){var n=l("div","".concat(Nt,"-toast")),r=l("div","".concat(Nt,"-dimmer active"));n.children(l("div","".concat(Nt,"-toast-header")).children(new Oe("close").on("click.stop",(function(){return document.body.removeChild(n.el),void document.body.removeChild(r.el)})),t),l("div","".concat(Nt,"-toast-content")).html(e)),document.body.appendChild(n.el),document.body.appendChild(r.el);var i=n.box(),o=i.width,a=i.height,c=document.documentElement,u=c.clientHeight,s=c.clientWidth;n.offset({left:(s-o)/2,top:(u-a)/3})}function ku(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Su=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=l("div","".concat(Nt,"-comment-tip")).hide()}var e,n,r;return e=t,(n=[{key:"hide",value:function(){this.el.hide()}},{key:"setPosition",value:function(t,e){var n=this.el,r=e.left+e.width,i=e.top-e.height/2;n.css("left","".concat(r,"px")),n.css("top","".concat(i,"px")),n.html(t).show()}}])&&ku(e.prototype,n),r&&ku(e,r),t}();function Ou(t){return(Ou="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ju(t,e,n){return(ju="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_u(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Eu(t,e){return(Eu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Cu(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=_u(t);if(e){var i=_u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ru(this,n)}}function Ru(t,e){return!e||"object"!==Ou(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _u(t){return(_u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Au=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Eu(t,e)}(o,t);var e,n,r,i=Cu(o);function o(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var e=new Ql(new Yl("120px",""),{required:!0},"".concat(tt("dataSearch.label"),":"),100);return(t=i.call(this,tt("toolbar.search"),[l("div","".concat(Nt,"-form-fields")).child(e.el),l("div","".concat(Nt,"-buttons")).children(new Ke("previous").on("click",(function(){return t.btnClick("previous")})),new Ke("next").on("click",(function(){return t.btnClick("next")})),new Ke("close","primary").on("click",(function(){return t.btnClick("close")})))],"500px",!1,!0)).formField=e,t.change=function(){},t}return e=o,(n=[{key:"btnClick",value:function(t){if("close"!==t){if(!this.formField.validate())return;var e=this.formField.val().toUpperCase().trim();switch(t){case"previous":this.change("previous",e);break;case"next":this.change("next",e)}}else this.hide()}},{key:"show",value:function(){ju(_u(o.prototype),"show",this).call(this),this.formField.input.focus()}}])&&xu(e.prototype,n),r&&xu(e,r),o}(Ll);function Pu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Tu(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,c=t[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Du(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Du(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Du(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Iu(t,e){var n,r=this;return function(){for(var i=r,o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];var l=a;n||(n=setTimeout((function(){n=null,t.apply(i,l)}),e))}}function zu(){var t=this.data,e=this.verticalScrollbar,n=this.horizontalScrollbar,r=t.getSelectedRect(),i=r.l,o=r.t,a=r.left,c=r.top,l=r.width,u=r.height,s=this.getTableOffset();if(Math.abs(a)+l>s.width)n.move({left:i+l-s.width});else{var f=t.freezeTotalWidth();a<f&&n.move({left:i-1-f})}if(Math.abs(c)+u>s.height)e.move({top:o+u-s.height-1});else{var h=t.freezeTotalHeight();c<h&&e.move({top:o-1-h})}}function Mu(){var t=this.data,e=this.verticalScrollbar,n=this.horizontalScrollbar,r=t._getSelectedRect(),i=r.l,o=r.t;n.move({left:i-1}),e.move({top:o-1})}function Nu(t,e,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(-1!==e||-1!==n){var o=this.table,a=this.selector,c=this.toolbar,l=this.data,u=this.contextMenu;u.setMode(-1===e||-1===n?"row-col":"range");var s=l.getCell(e,n);t?(a.setEnd(e,n,i),this.trigger("cells-selected",s,a.range)):(a.set(e,n,r),this.trigger("cell-selected",s,e,n)),c.reset(),o.render()}}function Hu(t,e){var n=this.selector,r=this.data,i=r.rows,o=r.cols,a=Tu(n.indexes,2),c=a[0],l=a[1],u=n.range,s=u.eri,f=u.eci;if(t){var h=Tu(n.moveIndexes,2);c=h[0],l=h[1]}"left"===e?l>0&&(l-=1):"right"===e?(f!==l&&(l=f),l<o.len-1&&(l+=1)):"up"===e?c>0&&(c-=1):"down"===e?(s!==c&&(c=s),c<i.len-1&&(c+=1)):"row-first"===e?l=0:"row-last"===e?l=o.len-1:"col-first"===e?c=0:"col-last"===e&&(c=i.len-1),t&&(n.moveIndexes=[c,l]),Nu.call(this,t,c,l),zu.call(this)}function Fu(t){if(0===t.buttons&&t.target.className!=="".concat(Nt,"-resizer-hover")){var e=t.offsetX,n=t.offsetY,r=this.rowResizer,i=this.colResizer,o=this.tableEl,a=this.data,c=a.rows,l=a.cols;if(e>l.indexWidth&&n>c.height)return r.hide(),void i.hide();var u=o.box(),s=a.getCellRectByXY(t.offsetX,t.offsetY);s.ri>=0&&-1===s.ci?(s.width=l.indexWidth,r.show(s,{width:u.width}),c.isHide(s.ri-1)?r.showUnhide(s.ri):r.hideUnhide()):r.hide(),-1===s.ri&&s.ci>=0?(s.height=c.height,s.top=0,i.show(s,{height:u.height}),l.isHide(s.ci-1)?i.showUnhide(s.ci):i.hideUnhide()):i.hide()}}function Wu(t){var e=this.verticalScrollbar,n=this.horizontalScrollbar,r=this.data,i=e.scroll().top,o=n.scroll().left,a=r.rows,c=r.cols,l=t.deltaY,u=t.deltaX,s=function(t,e){var n=t,r=0;do{r=e(n),n+=1}while(r<=0);return r},f=function(t){if(t>0){var n=r.scroll.ri+1;if(n<a.len){var o=s(n,(function(t){return a.getHeight(t)}));e.move({top:i+o-1})}}else{var c=r.scroll.ri-1;if(c>=0){var l=s(c,(function(t){return a.getHeight(t)}));e.move({top:0===c?0:i-l})}}},h=Math.abs(l),p=Math.abs(u),y=Math.max(h,p);/Firefox/i.test(window.navigator.userAgent)&&Iu(f(t.detail),50),y===p&&Iu(function(t){if(t>0){var e=r.scroll.ci+1;if(e<c.len){var i=s(e,(function(t){return c.getWidth(t)}));n.move({left:o+i-1})}}else{var a=r.scroll.ci-1;if(a>=0){var l=s(a,(function(t){return c.getWidth(t)}));n.move({left:0===a?0:o-l})}}}(u),50),y===h&&Iu(f(l),50)}function Vu(t,e){var n=this.verticalScrollbar,r=this.horizontalScrollbar,i=n.scroll().top,o=r.scroll().left;"left"===t||"right"===t?r.move({left:o-e}):"up"!==t&&"down"!==t||n.move({top:i-e})}function Uu(){var t=this.data,e=this.verticalScrollbar,n=this.getTableOffset().height,r=t.exceptRowTotalHeight(0,-1);e.set(n,t.rows.totalHeight()-r)}function qu(){var t=this.data,e=this.horizontalScrollbar,n=this.getTableOffset().width;t&&e.set(n,t.cols.totalWidth())}function $u(){var t=this.selector,e=this.data,n=this.editor,r=Tu(e.freeze,2),i=r[0],o=r[1];if(i>0||o>0){var a=e.freezeTotalWidth(),c=e.freezeTotalHeight();n.setFreezeLengths(a,c)}t.resetAreaOffset()}function Lu(){var t=this.tableEl,e=this.overlayerEl,n=this.overlayerCEl,r=this.table,i=this.toolbar,o=this.selector,a=this.el,c=this.getTableOffset(),l=this.getRect();t.attr(l),e.offset(l),n.offset(c),a.css("width","".concat(l.width,"px")),Uu.call(this),qu.call(this),$u.call(this),r.render(),i.reset(),o.reset()}function Bu(){var t=this.data,e=this.selector;t.clearClipboard(),e.hideClipboard()}function Yu(){var t=this.data,e=this.selector;t.copy(),e.showClipboard()}function Xu(){var t=this.data,e=this.selector;t.cut(),e.showClipboard()}function Zu(t,e){var n=this.data;if("read"!==n.settings.mode)if(n.paste(t,(function(t){return wu("Tip",t)})))Lu.call(this);else if(e){var r=e.clipboardData.getData("text/plain");this.data.pasteFromText(r),Lu.call(this)}}function Ku(){this.data.hideRowsOrCols(),Lu.call(this)}function Ju(t,e){this.data.unhideRowsOrCols(t,e),Lu.call(this)}function Gu(){this.data.autofilter(),Lu.call(this)}function Qu(){this.data.autoSort(),Lu.call(this)}function ts(){var t=this.toolbar;t.paintformatActive()&&(Zu.call(this,"format"),Bu.call(this),t.paintformatToggle())}function es(t){var e=this,n=this.selector,r=this.data,i=this.table,o=this.sortFilter,a=t.offsetX,c=t.offsetY,l=t.target.className==="".concat(Nt,"-selector-corner"),u=r.getCellRectByXY(a,c),s=u.left,f=u.top,h=u.width,p=u.height,y=u.ri,d=u.ci,v=r.autoFilter;if(v.includes(y,d)&&s+h-20<a&&f+p-20<c){var b=v.items(d,(function(t,e){return r.rows.getCell(t,e)}));return o.set(d,b,v.getFilter(d),v.getSort(d)),void o.setOffset({left:s,top:f+p+2})}t.shiftKey||(l?n.showAutofill(y,d):Nu.call(this,!1,y,d),zt(window,(function(t){var i=r.getCellRectByXY(t.offsetX,t.offsetY);y=i.ri,d=i.ci,l?n.showAutofill(y,d):1!==t.buttons||t.shiftKey||Nu.call(e,!0,y,d,!0,!0)}),(function(){l&&n.arange&&"read"!==r.settings.mode&&r.autofill(n.arange,"all",(function(t){return wu("Tip",t)}))&&i.render(),n.hideAutofill(),ts.call(e)}))),l||1!==t.buttons||t.shiftKey&&Nu.call(this,!0,y,d)}function ns(){var t=this.editor,e=this.data.getSelectedRect(),n=this.getTableOffset(),r="top";e.top>n.height/2&&(r="bottom"),t.setOffset(e,r)}function rs(){var t=this.editor,e=this.data;"read"!==e.settings.mode&&(e.getLocked()||(ns.call(this),t.setCell(e.getSelectedCell(),e.getSelectedValidator()),Bu.call(this)))}function is(t){var e=this,n=this.data,r=this.table,i=this.selector;n.scrolly(t,(function(){i.resetBRLAreaOffset(),ns.call(e),r.render()}))}function os(t){var e=this,n=this.data,r=this.table,i=this.selector;n.scrollx(t,(function(){i.resetBRTAreaOffset(),ns.call(e),r.render()}))}function as(t,e){var n=t.ri,r=this.table,i=this.selector;this.data.rows.setHeight(n,e),r.render(),i.resetAreaOffset(),Uu.call(this),ns.call(this)}function cs(t,e){var n=t.ci,r=this.table,i=this.selector;this.data.cols.setWidth(n,e),r.render(),i.resetAreaOffset(),qu.call(this),ns.call(this)}function ls(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"finished",n=this.data,r=this.table;if("read"!==n.settings.mode)if("finished"!==e||"="!==t[0]||n.validateFormula(t)){n.setSelectedCellText(t,e);var i=n.selector,o=i.ri,a=i.ci;if("finished"===e){if("server"===n.settings.updateMode)return;r.render()}else this.trigger("cell-edited",t,o,a)}else alert("formula Unclosed")}function us(t){var e=this.data;"insert-row"===t?e.insert("row"):"delete-row"===t?e.delete("row"):"insert-column"===t?e.insert("column"):"delete-column"===t?e.delete("column"):"delete-cell"===t?e.deleteCell():"delete-cell-format"===t?e.deleteCell("format"):"delete-cell-text"===t?e.deleteCell("text"):"cell-printable"===t?e.setSelectedCellAttr("printable",!0):"cell-non-printable"===t?e.setSelectedCellAttr("printable",!1):"cell-editable"===t?e.setSelectedCellAttr("editable",!0):"cell-non-editable"===t&&e.setSelectedCellAttr("editable",!1),Bu.call(this),Lu.call(this)}function ss(t,e){var n=this.data,r=this.modalSort,i=this.modalSearch;if("undo"===t)this.undo();else if("redo"===t)this.redo();else if("print"===t)this.print.preview();else if("paintformat"===t)!0===e?Yu.call(this):Bu.call(this);else if("clearformat"===t)us.call(this,"delete-cell-format");else if("link"===t);else if("chart"===t);else if("autofilter"===t)Gu.call(this);else if("freeze"===t)if(e){var o=n.selector,a=o.ri,c=o.ci;this.freeze(a,c)}else this.freeze(0,0);else"sort"===t?r.setValue(n.getSelectedSort()):"search"===t?i.show():(n.setSelectedCellAttr(t,e),"formula"!==t||n.selector.multiple()||rs.call(this),Lu.call(this))}function fs(t,e,n,r){this.data.setAutoFilter(t,e,n,r),Lu.call(this),this.data.updateConditionImageVisible()}function hs(){var t,e,n,r,i,o,a=this,c=this.selector,l=this.overlayerEl,u=this.rowResizer,s=this.colResizer,f=this.verticalScrollbar,h=this.horizontalScrollbar,p=this.editor,y=this.contextMenu,d=this.commentTip,v=this.toolbar,b=this.modalValidation,m=this.modalSort,g=this.modalSearch,w=this.sortFilter,k=this.el;l.on("mousemove",(function(t){Fu.call(a,t)})).on("mousedown",(function(t){p.clear(),y.hide(),d.hide(),2===t.buttons?(a.data.xyInSelectedRect(t.offsetX,t.offsetY)||es.call(a,t),y.setPosition(t.offsetX,t.offsetY),t.stopPropagation()):2===t.detail?rs.call(a):es.call(a,t)})).on("mousewheel.stop",(function(t){Wu.call(a,t)})).on("mouseout",(function(t){var e=t.offsetX;t.offsetY<=0&&s.hide(),e<=0&&u.hide()})),c.inputChange=function(t){ls.call(a,t,"input"),rs.call(a)},Pt(k.el,"mousemove",(function(t){d.hide();var e=t.offsetX,n=t.offsetY,r=a.data,i=r.comments,o=r.getCellRectByXY(e,n);o.ri>=0&&o.ci>=0&&i.forEach((function(t){o.ri===t.row&&o.ci===t.col&&d.setPosition(t.note,o)}))})),t=l.el,n=(e={move:function(t,e){Vu.call(a,t,e)}}).move,r=e.end,i=0,o=0,Pt(t,"touchstart",(function(t){var e=t.touches[0],n=e.pageX,r=e.pageY;i=n,o=r})),Pt(t,"touchmove",(function(t){if(n){var e=t.changedTouches[0],r=e.pageX,a=e.pageY,c=r-i,l=a-o;(Math.abs(c)>10||Math.abs(l)>10)&&(Mt(c,l,t,n),i=r,o=a),t.preventDefault()}})),Pt(t,"touchend",(function(t){if(r){var e=t.changedTouches[0],n=e.pageX,a=e.pageY;Mt(n-i,a-o,t,r)}})),v.change=function(t,e){return ss.call(a,t,e)},w.ok=function(t,e,n,r){return fs.call(a,t,e,n,r)},u.finishedFn=function(t,e){as.call(a,t,e)},s.finishedFn=function(t,e){cs.call(a,t,e)},u.unhideFn=function(t){Ju.call(a,"row",t)},s.unhideFn=function(t){Ju.call(a,"col",t)},f.moveFn=function(t,e){is.call(a,t,e)},h.moveFn=function(t,e){os.call(a,t,e)},p.change=function(t,e){ls.call(a,e,t)},b.change=function(t){if("save"===t){for(var e,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(e=a.data).addValidation.apply(e,r)}else a.data.removeValidation()},m.change=function(t,e,n,r){"ok"===t&&(Qu.call(a),fs.call(a,e,n,"all",r))},g.change=function(t,e){if("close"!==t){var n=a.data,r=n.search,i=n.rows,o=r.keywords,l=r.current,u=[];if(o===e)u=r.result;else{var s=i.len>0?i._:{};for(var f in s){var h=s[f].cells;for(var p in h){if(-1!==h[p].text.toUpperCase().indexOf(e)){var y={ri:f,ci:p};u.push(y)}}}r.keywords=e,r.result=u}if(0===u.length)return void alert("We couldn't find what you were looking for.");var d=Tu(c.indexes,2),v=d[0],b=d[1];for(var m in u){var g=Number(m)+1,w=u.length-1;if(Number(v)===Number(u[m].ri)&&Number(b)===Number(u[m].ci)){l=g;break}if(Number(v)<Number(u[0].ri)){l=0;break}if(Number(v)>=Number(u[m].ri)&&Number(v)<Number(u[g].ri)){l=g;break}if(Number(v)>Number(u[w].ri)){l=w+1;break}}switch(t){case"previous":l>1&&l--;break;case"next":l<u.length&&l++}var k=l>0?l:1;r.current=k,c.set(u[k-1].ri,u[k-1].ci),Mu.call(a)}},y.itemClick=function(t){"validation"===t?b.setValue(a.data.getSelectedValidation()):"sort"===t?m.setValue(a.data.getSelectedSort()):"copy"===t?Yu.call(a):"cut"===t?Xu.call(a):"paste"===t?Zu.call(a,"all"):"paste-value"===t?Zu.call(a,"text"):"paste-format"===t?Zu.call(a,"format"):"hide"===t?Ku.call(a):us.call(a,t)},Pt(window,"resize",(function(){a.reload()})),Pt(window,"click",(function(t){a.focusing=l.contains(t.target)})),Pt(window,"paste",(function(t){a.focusing&&(Zu.call(a,"all",t),t.preventDefault())})),Pt(window,"keydown",(function(t){if(a.focusing){var e=t.keyCode||t.which,n=t.key,r=t.ctrlKey,i=t.shiftKey,o=t.metaKey;if(r||o)switch(e){case 90:a.undo(),t.preventDefault();break;case 89:a.redo(),t.preventDefault();break;case 67:Yu.call(a),t.preventDefault();break;case 88:Xu.call(a),t.preventDefault();break;case 85:v.trigger("underline"),t.preventDefault();break;case 86:break;case 37:Hu.call(a,i,"row-first"),t.preventDefault();break;case 38:Hu.call(a,i,"col-first"),t.preventDefault();break;case 39:Hu.call(a,i,"row-last"),t.preventDefault();break;case 40:Hu.call(a,i,"col-last"),t.preventDefault();break;case 32:Nu.call(a,!1,-1,a.data.selector.ci,!1),t.preventDefault();break;case 66:v.trigger("bold");break;case 73:v.trigger("italic")}else{switch(e){case 32:i&&Nu.call(a,!1,a.data.selector.ri,-1,!1);break;case 27:y.hide(),d.hide(),Bu.call(a);break;case 37:Hu.call(a,i,"left"),t.preventDefault();break;case 38:Hu.call(a,i,"up"),t.preventDefault();break;case 39:Hu.call(a,i,"right"),t.preventDefault();break;case 40:Hu.call(a,i,"down"),t.preventDefault();break;case 9:p.clear(),Hu.call(a,!1,i?"left":"right"),t.preventDefault();break;case 13:p.clear(),Hu.call(a,!1,i?"up":"down"),t.preventDefault();break;case 8:us.call(a,"delete-cell-text"),t.preventDefault()}"Delete"===n?(us.call(a,"delete-cell-text"),t.preventDefault()):e>=65&&e<=90||e>=48&&e<=57||e>=96&&e<=105||"="===t.key?(ls.call(a,t.key,"input"),rs.call(a)):113===e&&rs.call(a)}}}))}var ps=function(){function t(e,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.eventMap=new Map;var i=n.settings,o=i.view,a=i.showToolbar,c=i.showContextmenu;this.el=l("div","".concat(Nt,"-sheet")),this.toolbar=new Wl(n,o.width,!a),this.print=new hr(n),e.children(this.toolbar.el,this.el,this.print.el),this.data=n,this.tableEl=l("canvas","".concat(Nt,"-table")),this.rowResizer=new Wt(!1,n.rows.height),this.colResizer=new Wt(!0,n.cols.minWidth),this.verticalScrollbar=new Ut(!0),this.horizontalScrollbar=new Ut(!1),this.editor=new qe(Pn,(function(){return r.getTableOffset()}),n.rows.height),this.modalValidation=new au,this.modalSort=new pu,this.modalSearch=new Au,this.contextMenu=new wr((function(){return r.getRect()}),!c),this.commentTip=new Su,this.selector=new ce(n),this.overlayerCEl=l("div","".concat(Nt,"-overlayer-content")).children(this.editor.el,this.selector.el),this.overlayerEl=l("div","".concat(Nt,"-overlayer")).child(this.overlayerCEl),this.sortFilter=new gu,this.el.children(this.tableEl,this.overlayerEl.el,this.rowResizer.el,this.colResizer.el,this.verticalScrollbar.el,this.horizontalScrollbar.el,this.contextMenu.el,this.commentTip.el,this.modalValidation.el,this.modalSort.el,this.modalSearch.el,this.sortFilter.el),this.table=new nr(this.tableEl.el,n),hs.call(this),Lu.call(this),Nu.call(this,!1,0,0)}var e,n,r;return e=t,(n=[{key:"on",value:function(t,e){return this.eventMap.set(t,e),this}},{key:"trigger",value:function(t){var e=this.eventMap;if(e.has(t)){for(var n,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(n=e.get(t)).call.apply(n,[this].concat(i))}}},{key:"resetData",value:function(t){this.editor.clear(),this.data=t,Uu.call(this),qu.call(this),this.toolbar.resetData(t),this.print.resetData(t),this.selector.resetData(t),this.table.resetData(t),this.data.reloadImagesShapes()}},{key:"loadData",value:function(t){return this.data.setData(t),Lu.call(this),this}},{key:"freeze",value:function(t,e){return this.data.setFreeze(t,e),Lu.call(this),this}},{key:"undo",value:function(){this.data.undo(),Lu.call(this)}},{key:"redo",value:function(){this.data.redo(),Lu.call(this)}},{key:"reload",value:function(){return Lu.call(this),this}},{key:"getRect",value:function(){var t=this.data;return{width:t.viewWidth(),height:t.viewHeight()}}},{key:"getTableOffset",value:function(){var t=this.data,e=t.rows,n=t.cols,r=this.getRect(),i=r.width,o=r.height;return{width:i-n.indexWidth,height:o-e.height,left:n.indexWidth,top:e.height}}}])&&Pu(e.prototype,n),r&&Pu(e,r),t}();function ys(t){return(ys="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ds(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,c=t[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return n}(t,e)||bs(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vs(t){return function(t){if(Array.isArray(t))return ms(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||bs(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function bs(t,e){if(t){if("string"==typeof t)return ms(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ms(t,e):void 0}}function ms(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function gs(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ws(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ks(t,e,n){return e&&ws(t.prototype,e),n&&ws(t,n),t}function Ss(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Os(t,e)}function Os(t,e){return(Os=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function xs(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Es(t);if(e){var i=Es(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return js(this,n)}}function js(t,e){return!e||"object"!==ys(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Es(t){return(Es=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Cs=function(t){Ss(n,t);var e=xs(n);function n(t){var r;gs(this,n);var i=new Oe("ellipsis");return(r=e.call(this,i,"auto",!1,"top-left")).contentClick=t,r}return ks(n,[{key:"reset",value:function(t){var e=this,n=t.map((function(t,n){return l("div","".concat(Nt,"-item")).css("width","150px").css("font-weight","normal").on("click",(function(){e.contentClick(n),e.hide()})).child(t)}));this.setContentChildren.apply(this,vs(n))}},{key:"setTitle",value:function(){}}]),n}(Fr),Rs=function(t){Ss(n,t);var e=xs(n);function n(t){var r;gs(this,n);var i=new Oe("pagination");return(r=e.call(this,i,"100px",!1,"top-left")).contentEl.css("max-height","298px"),r.contentEl.css("overflow-y","auto"),r.contentClick=t,r}return ks(n,[{key:"reset",value:function(t){var e=this,n=t.map((function(t,n){return l("div","".concat(Nt,"-item")).css("width","auto").css("font-weight","normal").on("click",(function(){e.contentClick(n),e.hide()})).child(t)}));this.setContentChildren.apply(this,vs(n))}}]),n}(Fr),_s=[{key:"delete",title:et("contextmenu.deleteSheet")}];function As(t){var e=this;return l("div","".concat(Nt,"-item")).child(t.title()).on("click",(function(){e.itemClick(t.key),e.hide()}))}function Ps(){var t=this;return _s.map((function(e){return As.call(t,e)}))}var Ts=function(){function t(){var e;gs(this,t),this.el=(e=l("div","".concat(Nt,"-contextmenu")).css("width","160px")).children.apply(e,vs(Ps.call(this))).hide(),this.itemClick=function(){}}return ks(t,[{key:"hide",value:function(){var t=this.el;t.hide(),Dt(t)}},{key:"setOffset",value:function(t){var e=this.el;e.offset(t),e.show(),It(e)}}]),t}(),Ds=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},c=arguments.length>5?arguments[5]:void 0;gs(this,t),this.settings=c,this.addFunc=n,this.swapFunc=r,this.updateFunc=o,this.scrollFunc=a,this.dataNames=[],this.activeEl=null,this.deleteEl=null,this.items=[],this.moreEl=new Cs((function(t){e.clickSwap2(e.items[t])})),this.paginationEl=new Rs((function(t){e.scrollFunc(t)})),this.contextMenu=new Ts,this.contextMenu.itemClick=i,this.el=l("div","".concat(Nt,"-bottombar")).children(this.contextMenu.el,this.menuEl=this.setMenuEl())}return ks(t,[{key:"setMenuEl",value:function(){var t=this;return"edit"===this.settings.mode?l("ul","".concat(Nt,"-menu")).child(l("li","").children(new Oe("add").on("click",(function(){t.dataNames.length<10?t.addFunc():wu("Warning","It is less than or equal to 10")})),l("span","").child(this.moreEl))):l("ul","".concat(Nt,"-menu")).child(l("li","").children(l("span","").child(this.moreEl)))}},{key:"addItem",value:function(t,e){this.dataNames.push(t);var n=l("li",e?"active":"").child(t);this.setItemEvent(n),e&&this.clickSwap(n),this.items.push(n),this.menuEl.child(n),this.moreEl.reset(this.dataNames)}},{key:"addPagination",value:function(t){for(var e=[],n=1;n<=t;n++){var r=n+"";e.push(r)}this.paginationEl.reset(e)}},{key:"setItemEvent",value:function(t){var e=this;"edit"===this.settings.mode?t.on("click",(function(){e.clickSwap2(t)})).on("contextmenu",(function(n){var r=n.target,i=r.offsetLeft,o=r.offsetHeight;e.contextMenu.setOffset({left:i,bottom:o+1}),e.deleteEl=t})).on("dblclick",(function(){var n=t.html(),r=new Yl("auto","");r.val(n),r.input.on("blur",(function(t){var r=t.target.value,i=e.dataNames.findIndex((function(t){return t===n}));e.renameItem(i,r)})),t.html("").child(r.el),r.focus()})):t.on("click",(function(){e.clickSwap2(t)}))}},{key:"renameItem",value:function(t,e){this.dataNames.splice(t,1,e),this.moreEl.reset(this.dataNames),this.items[t].html("").child(e),this.updateFunc(t,e)}},{key:"clear",value:function(){var t=this;this.items.forEach((function(e){t.menuEl.removeChild(e.el)})),this.items=[],this.dataNames=[],this.moreEl.reset(this.dataNames)}},{key:"deleteItem",value:function(){var t=this.activeEl,e=this.deleteEl;if(this.items.length>1){var n=this.items.findIndex((function(t){return t===e}));if(this.items.splice(n,1),this.dataNames.splice(n,1),this.menuEl.removeChild(e.el),this.moreEl.reset(this.dataNames),t===e){var r=ds(this.items,1)[0];return this.activeEl=r,this.activeEl.toggle(),[n,0]}return[n,-1]}return[-1]}},{key:"clickSwap2",value:function(t){var e=this.items.findIndex((function(e){return e===t}));this.clickSwap(t),this.activeEl.toggle(),this.swapFunc(e)}},{key:"clickSwap",value:function(t){null!==this.activeEl&&this.activeEl.toggle(),this.activeEl=t}}]),t}();n(1);function Is(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,c=t[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return zs(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return zs(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zs(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Ms(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ns(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Hs=function(){function t(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Ms(this,t);var i=e;this.options=r,this.sheetIndex=0,this.datas=[],this.uniqueid="",this.imageDiv=null,this.imageUrl=null,this.basicZorder=0,"string"==typeof e&&(i=document.querySelector(e)),this.bottombar=new Ds((function(){var t=n.addSheet();t.showGrid=!0,n.sheet.resetData(t)}),(function(t){var e=n.datas[t];e.scroll={ci:0,ri:0,riact:0,x:0,y:0,yact:0},n.sheet.resetData(e),n.resetPagination(e),n.sheet.verticalScrollbar.move({top:0})}),(function(){n.deleteSheet()}),(function(t,e){n.datas[t].name=e}),(function(t){var e=t*n.data.settings.row.len,r=n.data.rows.sumHeight(0,e);n.sheet.verticalScrollbar.move({top:r-1})}),this.options),this.isloading=!0,this.data=this.addSheet(),this.isloading=!1,this.resetPagination(this.data);var o=l("div","".concat(Nt)).on("contextmenu",(function(t){return t.preventDefault()}));i.appendChild(o.el),this.sheet=new ps(o,this.data),o.child(this.bottombar.el)}var e,n,r;return e=t,r=[{key:"locale",value:function(t,e){nt(t,e)}}],(n=[{key:"setImageInfo",value:function(t,e,n){return this.imageDiv=t,this.imageUrl=e,this.basicZorder=n,this}},{key:"addSheet",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=t||"sheet".concat(this.sheetIndex),i=new At(r,this.options);return i.change=function(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];(t=e.sheet).trigger.apply(t,["change"].concat(r))},i.updateCellsData=function(t){t.Error?console.error(t.Error):"update"===t.op&&(console.log("index js updateCellsData......."),t.data.forEach((function(t,n,r){for(var i=0;i<e.datas.length;i++)if(e.datas[i].name===t.name){e.datas[i].updateMyCells(t.cells),e.datas[i].updateShapes(t.shapes);break}})),e.sheet.data.updateShapeSrcToRefresh(),e.reRender())},i.updateServerError=function(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];(t=e.sheet).trigger.apply(t,["updateServerError"].concat(r))},i.updateCellServer=function(t){var n=e.sheet.data,r=n.settings,o=n.updateServerError,a=n.updateCellsData,c=e.uniqueid;"server"===r.updateMode&&(e.isupdating=!0,$.ajax({url:r.updateUrl,type:"post",dataType:"json",data:{p:JSON.stringify(t),uid:c},error:function(t,e,n){i.isupdating=!1,o(t,e,n)},success:function(t,e,n){i.isupdating=!1,a(t)}}))},i.loadImages=function(){var t=e.sheet.data.images,n=e.uniqueid,r=e.imageDiv,i=e.imageUrl,o=e.basicZorder;null!=t&&t.forEach((function(t){r.append('<img id="p_'+t.id+'" src="'+i+"?uid="+n+"&id="+t.id+"."+t.tick+'" class="resize-image"  alt="" style="position: absolute;top:'+t.top+"px;left:"+t.left+"px; z-index:"+(o+t.zorder)+";width: "+t.width+"px;height:"+t.height+'px">')}))},i.loadShapes=function(){var t=e.sheet.data.shapes,n=e.uniqueid,r=e.imageDiv,i=e.imageUrl,o=e.basicZorder;null!=t&&t.forEach((function(t){r.append('<img id="s_'+t.id+'" src="'+i+"?uid="+n+"&id="+t.id+"."+t.tick+'" class="resize-image"  alt="" style="position: absolute;top:'+t.top+"px;left:"+t.left+"px; z-index:"+(o+t.zorder)+";width: "+t.width+"px;height:"+t.height+'px">')}))},i.loadConditionImage=function(){var t=e.sheet.data.conditionimg,n=e.imageDiv,r=e.basicZorder;t&&t.forEach((function(t){if(t.data){var e=i.createConditionImage(t,r);t.data=void 0,t.image=e,n.append(e)}else n.append(t.image)}))},i.reloadImagesShapes=function(){var t=e.imageDiv;null!=t&&(t.empty(),i.loadImages(),i.loadShapes(),i.loadConditionImage())},this.datas.push(i),this.bottombar.addItem(r,n),this.sheetIndex+=1,this.isloading||this.sheet.data.addSheetOpr(r),i}},{key:"resetPagination",value:function(t){var e=t.rows.len,n=t.settings.row.len,r=e%n==0?e/n:Math.ceil(e/n);this.bottombar.addPagination(r)}},{key:"deleteSheet",value:function(){var t=Is(this.bottombar.deleteItem(),2),e=t[0],n=t[1];if(e>=0){var r=this.datas[e].name;this.sheet.data.delSheetOpr(r),this.datas.splice(e,1),n>=0&&this.sheet.resetData(this.datas[n])}}},{key:"loadData",value:function(t){this.isloading=!0;var e=Array.isArray(t)?t:[t];if(this.bottombar.clear(),this.datas=[],e.length>0)for(var n=0;n<e.length;n+=1){var r=e[n],i=this.addSheet(r.name,0===n);i.setData(r),0===n&&this.sheet.resetData(i)}return this.isloading=!1,this}},{key:"getData",value:function(){return this.datas.map((function(t){return t.getData()}))}},{key:"cellText",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return this.datas[r].setCellText(t,e,n,"finished"),this}},{key:"setActiveCell",value:function(t,e){return this.sheet.selector.set(t,e),this}},{key:"setActiveSheet",value:function(t){return this.bottombar.clickSwap2(this.bottombar.items[t]),this}},{key:"cell",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.datas[n].getCell(t,e)}},{key:"cellStyle",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.datas[n].getCellStyle(t,e)}},{key:"reRender",value:function(){return this.sheet.table.render(),this}},{key:"on",value:function(t,e){return this.sheet.on(t,e),this}},{key:"validate",value:function(){return this.data.validations.errors.size<=0}},{key:"change",value:function(t){return this.sheet.on("change",t),this}},{key:"updateServerError",value:function(t){return this.sheet.on("updateServerError",t),this}}])&&Ns(e.prototype,n),r&&Ns(e,r),t}(),Fs=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Hs(t,e)};window&&(window.x_spreadsheet=Fs,window.x_spreadsheet.locale=function(t,e){return nt(t,e)});e.default=Hs}]);